<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(240, 240, 240); color: rgb(68, 68, 68);">/**
 * Tree.scala
 */

sealed trait Tree[+A]
case class Leaf[<span class="hljs-string" style="color: rgb(136, 0, 0);">+A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">v: A</span>) extends Tree[A]
case class Branch[<span class="hljs-string" style="color: rgb(136, 0, 0);">+A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">l: Tree[A], r: Tree[A]</span>) extends Tree[A]

object Tree {
  def size[<span class="hljs-string" style="color: rgb(136, 0, 0);">A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">t: Tree[A]</span>): Int = t match {
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Leaf(v) =&gt; 1</span>
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Branch(l, r) =&gt; 1 + size(l) + size(r)</span>
  }
  
  def maximum(t: Tree[Int]): Int = t match {
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Leaf(v) =&gt; v</span>
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Branch(l, r) =&gt; maximum(l) max maximum(r)</span>
  }
  
  def depth[<span class="hljs-string" style="color: rgb(136, 0, 0);">A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">t: Tree[Int]</span>): Int = t match {
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Leaf(v) =&gt; 1</span>
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Branch(l, r) =&gt; 1 + (depth(l) max depth(r))</span>
  }
  
  def map[<span class="hljs-string" style="color: rgb(136, 0, 0);">A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">t: Tree[A]</span>)(f: (A) =&gt; A): Tree[A] = t match {
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Leaf(v) =&gt; Leaf(f(v))</span>
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Branch(l, r) =&gt; Branch(map(l)(f), map(r)(f))</span>
  }
  
  // f : Leaf에 적용될 함수, g : Branch에 적용될 함수
  def fold[<span class="hljs-string" style="color: rgb(136, 0, 0);">A, B</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">t: Tree[A]</span>)(f: (A) =&gt; B)(g: (B, B) =&gt; B): B = t match {
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Leaf(v) =&gt; f(v)</span>
<span class="hljs-code" style="color: rgb(57, 115, 0);">    case Branch(l, r) =&gt; g(fold(l)(f)(g), fold(r)(f)(g))</span>
  }
  
  def size2[<span class="hljs-string" style="color: rgb(136, 0, 0);">A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">t: Tree[A]</span>): Int = fold(t)((x) =&gt; 1)((l, r) =&gt; 1 + l + r)
  
  def maximum2(t: Tree[Int]): Int = fold(t)((x) =&gt; x)((l, r) =&gt; l max r)
  
  def depth2[<span class="hljs-string" style="color: rgb(136, 0, 0);">A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">t: Tree[A]</span>): Int = fold(t)((x) =&gt; 1)((l, r) =&gt; 1 + (l max r))
  
  def map2[<span class="hljs-string" style="color: rgb(136, 0, 0);">A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">t: Tree[A]</span>)(f: (A) =&gt; A): Tree[A] = fold(t)((x) =&gt; Tree(f(x)))((l, r) =&gt; Branch(l, r))
  
  def apply[<span class="hljs-string" style="color: rgb(136, 0, 0);">A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">v: A</span>): Tree[A] = Leaf(v)
  def apply[<span class="hljs-string" style="color: rgb(136, 0, 0);">A</span>](<span class="hljs-link" style="color: rgb(188, 96, 96);">l: Tree[A], r: Tree[A]</span>): Tree[A] = Branch(l, r)
}</pre>

<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(240, 240, 240); color: rgb(68, 68, 68);"><span class="hljs-comment" style="color: rgb(136, 136, 136);">/**
 * Main.scala
 */</span>

<span class="hljs-keyword" style="font-weight: 700;">import</span> Tree._

object Main {
	def main(args: <span class="hljs-keyword" style="font-weight: 700;">Array</span>[<span class="hljs-keyword" style="font-weight: 700;">String</span>]): Unit = {
	  var t = Tree(Tree(Tree(<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>), Tree(<span class="hljs-number" style="color: rgb(136, 0, 0);">2</span>)), Tree(<span class="hljs-number" style="color: rgb(136, 0, 0);">3</span>))
	  
	  <span class="hljs-built_in" style="color: rgb(57, 115, 0);">println</span>(Tree.<span class="hljs-built_in" style="color: rgb(57, 115, 0);">size</span>(t))
	  <span class="hljs-built_in" style="color: rgb(57, 115, 0);">println</span>(Tree.depth(t))
	  <span class="hljs-built_in" style="color: rgb(57, 115, 0);">println</span>(Tree.maximum(t))
	  <span class="hljs-built_in" style="color: rgb(57, 115, 0);">println</span>(Tree.maximum(Tree.<span class="hljs-built_in" style="color: rgb(57, 115, 0);">map</span>(t)((x) =&gt; x * <span class="hljs-number" style="color: rgb(136, 0, 0);">2</span>)))
	  
	  <span class="hljs-built_in" style="color: rgb(57, 115, 0);">println</span>(Tree.size2(t))
	  <span class="hljs-built_in" style="color: rgb(57, 115, 0);">println</span>(Tree.depth2(t))
	  <span class="hljs-built_in" style="color: rgb(57, 115, 0);">println</span>(Tree.maximum2(t))
	  <span class="hljs-built_in" style="color: rgb(57, 115, 0);">println</span>(Tree.maximum2(Tree.map2(t)((x) =&gt; x * <span class="hljs-number" style="color: rgb(136, 0, 0);">2</span>)))
	}
}</pre>