<hr>

<details>
    <summary>기존 프로젝트</summary>
    <details>
        <summary>외부 실행 흐름</summary>
        <img class="rounded mx-auto d-block" alt="기존 프로젝트 외부 시퀀스 다이어그램" src="imgs/20190719_100711.png">
    </details>

    <details>
        <summary>문제점</summary>
        <ol>
            <li>불필요한 중복 작업</li>
            <ul>
                <li>로직을 공유하는 2개 게임의 데이터 추출을 각각의 프로젝트로 관리</li>
                <li>불필요한 중복 코드 다수 존재</li>
            </ul>
            <li>미흡한 기능</li>
            <ul>
                <li>게임 업그레이드 작업시 2개 버전의 데이터를 추출해야 하지만, 프로젝트가 하나의 버전만 지원할 수 있어 별도 빌드 필요</li>
                <li>예외 발생 시 메시지로 보고만 한 뒤 프로그램 종료</li>
                <li>xls 한 행마다 DB 서버에 질의하여 불필요한 IO 대기가 많음</li>
                <li>모든 작업이 UI 스레드에서 동작하여 하나를 시작하면 종료될 때까지 기다려야만 함</li>
            </ul>
            <li>xls 템플릿 파일을 이용하여 사본을 저장하는 방식의 문제</li>
            <ul>
                <li>업그레이드 작업 시 프로젝트 내부 모델 수정 외에 별도의 템플릿 수정이 필요</li>
                <li>템플릿을 이용하는 방식은 하나의 모델 버전만 지원 가능</li>
            </ul>
        </ol>
    </details>
</details>

<hr>

<details>
    <summary>통합 프로젝트</summary>
    <details>
        <summary>실행 화면</summary>
        <img class="rounded mx-auto d-block" alt="실행 화면1" src="imgs/20190723_100443.png">
        <img class="rounded mx-auto d-block" alt="실행 화면2" src="imgs/20190723_100506.png">
    </details>

    <details>
        <summary>외부 실행 흐름</summary>
        <img class="rounded mx-auto d-block" alt="통합 프로젝트 외부 시퀀스 다이어그램" src="imgs/20190719_103028.png">
    </details>

    <details>
        <summary>주요 수정 사항</summary>
        <ol>
            <li>C# WinForm 프로젝트 2개를 단일 C#.NET WPF 프로젝트로 옮기면서 MVVM 구조로 재설계</li>

            <li>단일 프로젝트에서 여러 모델 버전 동시 지원</li>
            추출하기 위해 선택한 DB 서버에 따라서 알아서 해당 버전에 유효한 컬럼들로만 xls 추출

            <li>빌드 파일을 압축하여 공유하는 방식에서 원클릭 업데이트로 변경</li>
            
            <li>불필요한 포그라운드 작업을 백그라운드로 전환</li>
            각 작업들을 서비스 클래스의 메서드로 변경하였고, 커맨드 패턴을 이용하여 백그라운드 스레드로 자동 구성하도록 변경.
            
            <li>투박한 디자인 대신 머티리얼 디자인으로 UX 개선</li>

            <li>DB IO 낭비 개선, 엑셀 시트 작성 개선, 기타 지속적인 리팩터링</li>
        </ol>
    </details>

    <details>
        <summary>Code Snippet</summary>
        <ol>
            <li><a role="button" target="_blank" class="btn btn-info btn-sm" href="https://github.com/Dong-gi/Dong-gi.github.io/tree/master/Repositories/VisualStudio/Project1%20EventGenerator">비즈니스 로직을 제거한 프로젝트</a>
                <a role="button" target="_blank" class="btn btn-info btn-sm" href="https://github.com/Dong-gi/Dong-gi.github.io/tree/master/Repositories/VisualStudio/Project1%20EventGenerator/LICENSE.md">라이선스</a></li>
            
            <li>MVVM 커맨드 패턴</li>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/MainWindow.xaml" displayRange="[1, 1, 6, 7, 20, 22, 69, 75, 257, 263]" lan="xml">DataContext 연결 및 커맨드 호출</button>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/ViewModel/MainViewModel.cs" displayRange="[26, 27, 31, 31, 98, 100, 108, 112, 117, 117, 219, 219]" lan="cs">커맨드 연결</button>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/Utility/CustomCommand.cs" lan="cs">커스텀 커맨드</button>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/Model/Constants.cs" displayRange="[9, 10, 23, 35, 45, 45]" lan="cs">오타 방지를 위한 커맨드 상수</button>

            <li>Console.Write, Console.WriteLine 리다이렉트</li>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/Utility/ConsoleRedirectWriter.cs" lan="cs">리다이렉트 유틸리티 클래스</button>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/ViewModel/MainViewModel.cs" displayRange="[99, 100, 114, 118, 198, 206]" lan="cs">리다이렉트 사용</button>

            <li>xls 작성</li>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/ViewModel/Game1ViewModel.cs" displayRange="[65, 76]" lan="cs">ViewModel</button>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/Service/Game1Service.cs" lan="cs">Service</button>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/Model/Game1Context.cs" lan="cs">Game1Context</button>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/Model/BaseContext.cs" lan="cs">BaseContext</button>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/Utility/CustomExcelDataUtility.cs" lan="cs">CustomExcelDataUtility</button>
            <button class="btn-code" path="Repositories/VisualStudio/Project1 EventGenerator/Utility/CustomExcel.cs" displayRange="[82,154]" lan="cs">CustomExcel</button>
        </ol>
    </details>
</details>

<hr>