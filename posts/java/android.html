<html lnag="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="google-site-verification" content="aH-DyzdytYQ0NPHNQFcs5dVoiu5YNs6CEEHYgqDmAFM"><meta name="author" content="Donggi Kim &lt;hi.donggi@gmail.com&gt;"><meta name="keywords" content="Android"><meta name="description" content="Android 정리"><title>Android</title><link id="w3css" rel="stylesheet" href="/source/w3.css"><link id="highlight-style" rel="stylesheet" href="/source/xcode.css"><link id="default-style" rel="stylesheet" href="/source/default.css"><script id="highlight-js" src="/source/highlight.pack.js"></script><script id="default-js" src="/source/default.min.js"></script><script id="dsq-count-scr" src="//donggi.disqus.com/count.js" async></script><script id="kakao-ads" src="//t1.daumcdn.net/kas/static/ba.min.js" async></script><script id="google-ads" data-ad-client="ca-pub-7897366614471210" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><script id="google-analytics" src="https://www.googletagmanager.com/gtag/js?id=UA-143098403-1" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-143098403-1');</script></head><body><div id="sidebar" class="w3-bar-block w3-sidebar w3-animate-left"><hr><a href="javascript:closeSidebar();" class="w3-bar-item w3-button">Close &times;</a><hr><div id="marker-list"></div><hr><div id="post-list"></div><hr><div class="w3-center"><ins style="display:none;" data-ad-unit="DAN-1k1r635zxb6g3" data-ad-width="300" data-ad-height="250" class="kakao_ad_area"></ins></div><hr><div id="file-list"></div><hr></div><div id="main"><div id="nav" style="position:-webkit-sticky;position:sticky;top:0px;vertical-align:middle" class="w3-bar w3-blue w3-large"><button onclick="toggleSidebar()" class="w3-bar-item w3-button w3-hover-theme">&#9776;</button><input id="query" type="text" placeholder="search" class="w3-bar-item"></div><div id="contents" class="w3-padding"><h1 class="marker">시작하기</h1><div><h2 class="marker">Hello World</h2><ol><li>기본 설정대로 프로젝트를 생성하면 아래의 4개 주요 파일을 볼 수 있다.</li><li>MainActivity.java</li><p>앱을 실행하면 이 클래스의 인스턴스가 실행되고 layout을 로드한다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project01/app/src/main/java/io/github/donggi/project01/MainActivity.java" lan="java">MainActivity.java »</button></p><li>activity_main.xml</li><p>액티비티의 UI를 정의한다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project01/app/src/main/res/layout/activity_main.xml" lan="xml">activity_main.xml »</button></p><li>AndroidManifest.xml</li><p>앱의 기본적인 특성을 기술하고, 각 컴포넌트를 정의한다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project01/app/src/main/AndroidManifest.xml" lan="xml">AndroidManifest.xml »</button></p><li>build.gradle</li><p>앱의 컴파일과 빌드에 관한 구성 설정.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project01/build.gradle" lan="gradle">Project Gradle »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project01/app/build.gradle" lan="gradle">"app" module Gradle »</button></p></ol><h2 class="marker">앱 컴포넌트</h2><ol><li>Activity : UI가 있는 단일 화면. 액티비티는 한 번에 하나만 실행할 수 있다.</li><p>Project window » 우클릭 » New » Activity : 자동으로 매니페스트에도 추가된다.</p><p>액티비티 시작 : startActivity() or startActivityForResult()</p><p>액티비티 생애주기 : onCreate(인스턴스 생성 시), onRestart(재시작), onStart(onCreate, onRestart 후), onResume(포그라운드), onPause(백그라운드), onStop(비가시영역 진입), onDestroy(소멸)</p><p>xml에서 saveEnabled 속성을 true로 하면 onSaveInstanceState, onRestoreInstanceState 메서드를 재정의하여 사용할 수 있다.</p><li>Service : 백그라운드에서 실행되는 요소.</li><p>서비스 시작 : startService() or bindService()</p><li>ContentProvider : 외부로 공유하는 데이터 집합 관리.</li><p>ContentProvider 이용 : ContentResolver.query()</p><li>BroadcastReceiver : 각 브로드캐스트는 Intent 객체로 전달된다.</li><p>브로드캐스트 송신 : sendBroadcast(), sendOrderedBroadcast(), sendStickyBroadcast()</p><li>Intent : 컴포넌트 간의 데이터 전달.</li><ul><li>Activity, Service, BroadcastReceiver는 Intent로 활성화되고, ContentProvider는 ContentResolver의 요청으로 활성화된다.</li><li>public Intent(Context packageContext, Class cls)</li><li>Intent putExtra(String name, ? value)</li><li>명시적 인텐트 : 수신 클래스 지정</li><li>암시적 인텐트 : 작업을 처리할 수 있는 컴포넌트로 안드로이드가 연결</li><li>브로드캐스트 인텐트 : 브로드캐스트 리시버로 등록된 모든 수신자에게 전송</li></ul><li>Fragment : Deprecated in API level 28</li></ol><h2 class="marker">매니페스트</h2><ol><li>구성 요소 선언, 요구 권한 식별, 최소 API 레벨 선언 등</li><p>&lt;activity>, &lt;service>, &lt;receiver>, &lt;provider></p><p>BroadcastReceiver는 registerReceiver()를 통해 동적으로 등록할 수 있다.</p><li>다른 앱의 intent에 응답하기 위해 &lt;intent-filter>요소를 해당 요소의 하위에 추가한다.</li><li>요구사항 선언</li><strong>↓ xml</strong><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;!-- 예. 카메라 없으면 구글 플레이에서 설치 불가 -->
&lt;uses-feature android:name="android.hardware.camera.any" android:required="true"/>
    &lt;!-- http://developer.android.com/guide/topics/manifest/uses-feature-element.html#features-reference -->

&lt;!-- API 7이상 -->
&lt;uses-sdk android:minSdkVersion="7" android:targetSdkVersion="19" />
</div><li>application 엘리먼트</li><p>많은 메모리를 필요로 하는 경우에만 android:largeHeap 속성 이용</p><li>컴포넌트 엘리먼트</li><p>설정이 완료되기 전까지 기능을 제한하려는 경우, android:enabled 속성을 이용해 Activity, Service, BroadcastReceiver의 동작을 막을 수 있다.</p><strong>↓ java</strong><div lan="java" class="as-code code-div w3-leftbar w3-border-green">PackageManager manager = getPackageManager();
manager.setComponentEnabledSetting(
    new ComponentName(this, MainActivity.class),
    PackageManager.COMPONENT_ENABLED_STATE_ENABLED,
    PackageManager.DONT_KILL_APP
);
</div><li>인텐트 필터링 예</li><strong>↓ xml</strong><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;activity ~>
    &lt;intent-filter>
        &lt;action android:name="android.intent.action.VIEW"/>
        &lt;category android:name="android.intent.category.DEFAULT"/>
        &lt;data android:mimeType="video/*"/>
    &lt;/intent-filter>
&lt;/activity>
</div></ol><h2 class="marker">UI</h2><ol><li>안드로이드 UI는 layout(ViewGroup 객체)들과 widget(View 객체)들의 계층으로 이루어진다.</li><li>길이 단위</li><ul><li>px : 픽셀. 장치마다 밀도가 달라 제각기로 표현된다.</li><li>dp : Density-independent pixels. 160dp는 밀도와 관계없이 1인치로 표시된다.</li><li>mm : 밀리미터</li><li>in : 인치</li><li>pt : 포인트 = 1/72 인치</li></ul><li>View</li><ul><li>버튼, 텍스트 박스 등의 UI 요소</li><p>TextView, EditText, Button, ImageView, Switch, ...<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project04/app/src/main/res/layout/activity_main2.xml" lan="xml">View Code »</button></p><li>id 속성 : @[+]id/ID</li><p>ID를 할당할 때는 +를 앞에 붙여 R 클래스의 상수로 등록되도록 한다.</p><li>layout_width, layout_height : 너비, 높이</li><p>match_parent : 부모 요소의 크기만큼 할당, wrap_content : 내용물만큼 할당, 상수 지정 : 크기 고정</p><li>background : 배경. 지정하지 않으면 각 뷰의 기본값이 사용된다</li><li>visibility : 가시성. visible | invisible | gone</li><li>padding, layout_margin</li></ul><li>ViewGroup</li><ul><li>자식 요소들을 어디에 위치시킬 지 조정한다.</li><li>ConstraintLayout</li><p>형제 요소들과 부모 레이아웃에 대한 거리를 통해 뷰를 조정한다.</p><p>여러 요소들을 선택하여 우클릭한 뒤 chain으로 연결하면 한 번에 가로/세로로 배치할 수 있다.</p><li>LinearLayout</li><p>orientation 속성으로 horizontal | vertical 지정</p><p>gravity 속성으로 정렬 가능. center_horizontal(0x01), left(0x03), right(0x05), fill_horizontal(0x07), center_vertical(0x10), top(0x30), bottom(0x50), fill_vertical(0x70), center(0x11), fill(0x77)</p><p>baselineAligned 속성으로 요소들의 아래 줄을 일치시킬 지 여부를 지정할 수 있다</p><p>요소의 layout_weight 속성으로 너비/높이를 일정 비율씩 나눠가질 수 있다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project04/app/src/main/res/layout/activity_main.xml" lan="xml">View Code »</button></p><li>GridLayout</li><p>화면의 가로/세로(columnCount/rowCount)를 잘라 만든 격자를 이용해 배치.</p></ul><li>UI를 업데이트할 때엔 새 Runnable을 생성해 activity.runOnUiThread() 호출</li><li>EventListener</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project04/app/src/main/res/layout/activity_main3.xml" lan="xml">xml »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project04/app/src/main/java/io/github/donggi/project04/Main3Activity.java" lan="java">java »</button><li>테마 적용 예</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project05/app/src/main/AndroidManifest.xml" lan="xml">AndroidManifest.xml »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project05/app/src/main/res/layout/activity_main.xml" lan="xml">activity_main.xml »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project05/app/src/main/java/io/github/donggi/project05/MainActivity.java" lan="java">MainActivity.java »</button><li>BottomNavigationView</li><p>com.google.android.material:material 포함.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project04/app/build.gradle" lan="gradle">"app" module Gradle »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project04/app/src/main/res/layout/activity_main4.xml" lan="xml">activity xml »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project04/app/src/main/res/layout/navigator.xml" lan="xml">navigator xml »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project04/app/src/main/res/menu/navigation.xml" lan="xml">navigation xml »</button></p><p>Used icons made by</p><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://www.flaticon.com/authors/smashicons" target="_blank">Smashicons</a> from<a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://www.flaticon.com/" target="_blank">www.flaticon.com</a> is licensed by<a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="http://creativecommons.org/licenses/by/3.0/" target="_blank">CC 3.0 BY</a></ol></div><h1 class="marker">SQLite</h1><ol><li>https://developer.android.com/jetpack/androidx/releases/room</li><li>https://developer.android.com/training/data-storage/room</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project06/app/build.gradle" lan="gradle">"app" module Gradle »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project06/app/src/main/java/io/github/donggi/project06/dto/User.java" lan="java">User.java »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project06/app/src/main/java/io/github/donggi/project06/dao/UserDao.java" lan="java">UserDao.java »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project06/app/src/main/java/io/github/donggi/project06/DB.java" lan="java">DB.java »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project06/app/src/main/java/io/github/donggi/project06/MainActivity.java" lan="java">MainActivity.java »</button></ol><h1 class="marker">권한 요청</h1><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project03/app/src/main/java/io/github/donggi/project03/MainActivity.java" lan="java">MainActivity.java »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project03/app/src/main/AndroidManifest.xml" lan="xml">AndroidManifest.xml »</button><h1 class="marker">알림 보내기</h1><p>매니페스트 설정 불필요<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project02/app/src/main/res/layout/activity_main.xml" lan="xml">activity_main.xml »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project02/app/src/main/java/io/github/donggi/project02/MainActivity.java" lan="java">MainActivity.java »</button></p><h1 class="marker">SensorManager</h1><ul><li>https://developer.android.com/guide/topics/sensors/sensors_overview.html?hl=ko</li><li>SensorManager, Sensor, SensorEvent, SensorEventListener</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project07/app/src/main/java/io/github/donggi/project07/example/ListAllSensorsExample.java" lan="java">ListAllSensorsExample.java »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project07/app/src/main/java/io/github/donggi/project07/example/AccelerometerExample.java" lan="java">AccelerometerExample.java »</button><li>걸음 감지 예</li><strong>↓ java</strong><div lan="java" class="as-code code-div w3-leftbar w3-border-green">for(int i = 0; i &lt; 3; ++i)
    innerProduct += linearAccelValue[i] * accelValue[i];
float projection = innerProduct / 9.8f;
//LogManager.log(TAG, "중력 방향 가속도 : " + projection + "m/s^2");
// 왕복 운동의 한쪽만 카운트(양의 가속도)
if(projection >= thresh) {
    lastDetected = System.currentTimeMillis();
}
</div></ul><h1 class="marker">Location Manager</h1><strong>↓ xml</strong><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
&lt;uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/></div><div><h2 class="marker">위치 소스 provider</h2><ol><li>GPS : LocationManager.GPS_PROVIDER, 오차 ~수십 미터, 배터리 소모 많음, 긴 TTFF(Time To First Fix). ACCESS_FINE_LOCATION 권한 필요</li><li>기지국 : LocationManager.NETWORK_PROVIDER, 오차 ~수백 미터, 짧은 TTFF, 적은 배터리 소모. ACCESS_COARSE_LOCATION 권한 필요</li><li>LocationManager.PASSIVE_PROVIDER : 다른 앱이 요청한 위치 정보를 사용, ACCESS_FINE_LOCATION 권한 필요</li></ol><h2 class="marker">LocationManager</h2><ol><li>List&lt;String> getProviders (boolean enabledOnly)</li><li>void requestLocationUpdates(String provider, long minTime, float minDistance, LocationListener listener) + removeUpdates</li><p>minTime : 업데이트 간 최소 시간(ms), minDistance : 업데이트 간 최소 거리(m)<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project07/app/src/main/java/io/github/donggi/project07/example/LocationExample.java" lan="java">LocationExample.java »</button></p><li>void requestSingleUpdate (String provider, PendingIntent intent)</li><li>void addProximityAlert (double latitude, double longitude, float radius, long expiration, PendingIntent intent) + removeProximityAlert</li><p>근접 경보. 등록한 영역에 들어가거나 나갈 때 인텐트로 알림. ACCESS_FINE_LOCATION 권한 필요<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Android/Project07/app/src/main/java/io/github/donggi/project07/example/ProximityAlertExample.java" lan="java">ProximityAlertExample.java »</button></p><p>expiration : 기한 내에 도착하지 못하면 알림 취소. -1이면 무기한.</p><p>intent로 KEY_PROXIMITY_ENTERING이라는 boolean 값 전달. true면 들어가는 것, false면 나가는 것.</p></ol><h2 class="marker">LocationListener</h2><ol><li>void onLocationChanged(Location location)</li><li>void onProviderEnabled(String provider) + onProviderDisabled</li><p>사용자가 위치 설정의 ON/OFF를 변경할 때</p><li>void onStatusChanged(String provider, int status, Bundle extras)</li><p>Deprecated Since 29 : 절대 호출되지 않는다.</p><p>GPS를 이용하도록 설정했음에도 신호가 수신되지 않는 경우 등.</p><p>status : LocationProvider.OUT_OF_SERVICE, LocationProvider.TEMPORARILY_UNAVAILABLE, LocationProvider.AVAILABLE</p></ol></div><h1 class="marker">백그라운드, 절전 모드에서의 실행</h1><ol><li>CPU 항상 켜기 필요 권한 : android.permission.WAKE_LOCK</li><strong>↓ java</strong><div lan="java" class="as-code code-div w3-leftbar w3-border-green">PowerManager manager = (PowerManager)getSystemService(Context.POWER_SERVICE);
PowerManager.WakeLock lock = manager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "TAG_FOR_DEBUG");
lock.acquire();
// business logic
lock.release();</div><li>화면 항상 켜기</li><p>xml : android:keepScreenOn="true" 또는<br>java : getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);</p><li>주기적인 백그라운드 알람</li><strong>↓ java</strong><div lan="java" class="as-code code-div w3-leftbar w3-border-green">AlarmManager manager = (AlarmManager)getSystemService(ALARM_SERVICE);
// 1회 알람 : set(int type, long triggerAtMillis, PendingIntent operation)
// 1회 정시 알람 : setExact(int type, long triggerAtMillis, PendingIntent operation) + 오버로딩
manager.setExact(AlarmManager.ELAPSED_REALTIME_WAKEUP, SystemClock.elapsedRealtime()+5000, pendingIntent);
// 반복 알람 : setRepeating(int type, long triggerAtMillis, long intervalMillis, PendingIntent operation)
// Since 19 : 모든 반복 알람은 부정확하다.</div><div><h3 class="marker">알람 type</h3><ol><li>RTC : System#currentTimeMillis로 얻어지는 시각 기준</li><li>ELAPSED_REALTIME : SystemClock#elapsedRealtime로 얻어지는, 부팅 후 경과 시간 기준</li><li>RTC_WAKEUP, ELAPSED_REALTIME_WAKEUP : *_WAKEUP 타입은 기기가 자고 있으면 깨워서 실행시킨다</li></ol></div><li>Doze 모드 Since 23</li><p>네트워크 액세스 정지. WAKE_LOCK 무시. AlarmManager 경보 무시. Wi-Fi 검색 X, JobScheduler 실행 X, AbstractThreadedSyncAdapter 실행 X</p><ul><li>AlarmManager#setAndAllowWhileIdle, setExactAndAllowWhileIdle를 사용해야 한다</li><li>AlarmManager#setAlarmClock으로 설정된 경보는 정상적으로 실행되며, 실행 직전에 doze 모드가 종료된다.</li></ul><li>AsyncTask</li><p>onPreExecute(), onProgressUpdate, onPostExecute : 메인 스레드에서 실행된다</p><li>Application 객체를 통한 공유</li><p>안드로이드 애플리케이션은 항상 Application 컴포넌트를 하나 갖고 있으며, Context#getApplication로 접근 가능하다<br>사용자 정의 Application을 사용하는 경우, 매니페스트의 name 속성을 변경해주고, getApplication() 결과를 캐스팅해야 한다.</p></ol><h1 class="marker">ProGuard</h1><ol><li>코드 최적화 및 난독화</li><li>build.gradle의 안드로이드 영역에 아래를 추가</li><strong>↓ gradle</strong><div lan="gradle" class="as-code code-div w3-leftbar w3-border-green">buildTypes {
    release {
        runProguard true
        proguardFile getDefaultProguardFile('proguard-android.txt')
    }
}
</div></ol><h1 class="marker">최적화</h1><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://developer.android.com/topic/performance" target="_blank">performance</a></div><hr>&copy; 2020. <a href="mailto:hi.donggi@gmail.com">Donggi Kim</a> all rights reserved.<a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="/LICENSE" target="_blank">LICENSE</a></div></body></html>