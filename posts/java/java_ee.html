<html lnag="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="google-site-verification" content="aH-DyzdytYQ0NPHNQFcs5dVoiu5YNs6CEEHYgqDmAFM"><meta name="author" content="Donggi Kim &lt;hi.donggi@gmail.com&gt;"><meta name="keywords" content="JavaEE, Servlet, tomcat, JSP, Spring"><meta name="description" content="JavaEE 정리"><title>JavaEE</title><link id="w3css" rel="stylesheet" href="/source/w3.css"><link id="highlight-style" rel="stylesheet" href="/source/xcode.css"><link id="default-style" rel="stylesheet" href="/source/default.css"><script id="highlight-js" src="/source/highlight.pack.js"></script><script id="default-js" src="/source/default.min.js"></script><script id="dsq-count-scr" src="//donggi.disqus.com/count.js" async></script><script id="google-analytics" src="https://www.googletagmanager.com/gtag/js?id=UA-143098403-1" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-143098403-1');</script></head><body><div id="sidebar" class="w3-bar-block w3-sidebar w3-animate-left"><hr><a href="javascript:closeSidebar();" class="w3-bar-item w3-button">Close &times;</a><hr><div id="marker-list"></div><hr><div id="post-list"></div><hr><div id="file-list"></div><hr></div><div id="main"><div id="nav" style="position:-webkit-sticky;position:sticky;top:0px;vertical-align:middle" class="w3-bar w3-blue w3-large"><button onclick="toggleSidebar()" class="w3-bar-item w3-button w3-hover-theme">&#9776;</button><input id="query" type="text" placeholder="search" class="w3-bar-item"><a href="/" class="w3-bar-item w3-button w3-hover-theme">Home</a></div><div id="contents" class="w3-padding"><h1 class="marker">JavaEE</h1><ol><li>Java Enterprise Edition은 동적 웹 애플리케이션 개발을 위한 자바 플랫폼이다.</li><p>JavaSE와는 문서 페이지가 다르다. <a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://javaee.github.io/javaee-spec/javadocs/">Reference</a></p><li>WAR(Web Application Archive) : JavaEE 웹 애플리케이션을 위한 압축 파일</li><p>전통적인 war 파일 구조 ↓</p><p><strong>↓ text</strong></p><div lan="text" class="as-code code-div w3-leftbar w3-border-green">웹앱 루트
ㄴ META-INF
    ㄴ MANIFEST.MF
    ㄴ 컨테이너 지원
ㄴ WEB-INF : 웹에서 접근 불가
    ㄴ classes
        ㄴ META-INF
            ㄴ 애플리케이션 자원
        ㄴ 자바 .class 파일 및 자원
    ㄴ i88n
        ㄴ 국제화 파일
    ㄴ lib
        ㄴ 번들 jar 파일
    ㄴ tags
        ㄴ JSP 태그 파일
    ㄴ tld
        ㄴ JSP 태그 라이브러리 설명자
ㄴ 기타 웹에서 접근 가능한 파일</div><li>서블릿</li><p>자바로 구현된 CGI(Common Gateway Interface; 웹 서버와 프로그램 사이의 통신 규약).
 JCP(Java Community Process)에서 제정한 Servlet Specification을 따라야 한다.</p><li>서블릿 컨테이너</li><p>서블릿의 생애를 관리하는 프로그램(예. 톰캣)</p><li>JSP</li><p>전용 태그 "&lt;% %>"를 이용해 HTML 문서에 자바 코드를 삽입.
 컨테이너가 자동으로 컴파일 하며, 서블릿 클래스와 달리 수정사항이 있어도 다시 빌드할 필요가 없다.</p></ol><h1 class="marker">톰캣 배포 프로젝트</h1><div><h2 class="marker">개발 환경</h2><ol><li><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="http://openjdk.java.net/install/">OpenJDK</a> 설치</li><li><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://tomcat.apache.org/">톰캣</a> 설치</li><li>IDE(이클립스, STS 등) 설치</li><ul><li>이클립스에 톰캣 추가</li><p><strong>↓ text</strong></p><div lan="text" class="as-code code-div w3-leftbar w3-border-green">Windows » Preferences » Server » Runtime Environments » Add » Apache</div><li>이클립스 프로젝트에 톰캣 구성 추가</li><p><strong>↓ text</strong></p><div lan="text" class="as-code code-div w3-leftbar w3-border-green">프로젝트 Server 속성에 추가.</div><li>IntelliJ에 톰캣 추가</li><p><strong>↓ text</strong></p><div lan="text" class="as-code code-div w3-leftbar w3-border-green">Settings » Application Servers » + » 톰캣 홈 디렉터리 추가</div><li>IntelliJ 프로젝트에 톰캣 구성 추가</li><p><strong>↓ text</strong></p><div lan="text" class="as-code code-div w3-leftbar w3-border-green">도구 모음에서 Run/Debug Configurations 아이콘(아래방향 화살표)을 누른 다음 Edit Configurations 클릭

대화상자가 열리면 + 버튼 클릭 후 Tomcat Server를 Local로 추가.

배포할 아티팩트를 선택하지 않았다는 경고가 표시되면 Deployment 탭을 누르고 "Deploy at the server setup" 머리글 아래의 + 버튼 클릭.
Artifact를 누르고 확장된 war 파일 아티팩트를 누른 다음 OK. 배포를 위한 "Application context"이름을 서버를 기준으로 한 상대 주소로 변경(예. /my-app)
</div></ul></ol><h2 class="marker">Hello World 프로젝트</h2><div><h3 class="marker">이클립스 Dynamic Web Project</h3><ol><li>New Project » Web » Dynamic Web Project » Target runtime에 톰캣 설정</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20180929_220300.png" class="w3-round"></div><li>코드 작성</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20180929_220301.png" class="w3-round"></div><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/servlet/Hello1.java" lan="java">Hello1.java »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/webapp/WEB-INF/web.xml" lan="xml">web.xml »</button><li>web.xml</li><p>web.xml은 배포 설명자로, 서블릿 및 서블릿 매핑, 필터 등을 정의한다.
 이클립스 프로젝트 생성 마법사로 web.xml을 생성하면 자동으로 welcome-file-list를 구성해주는데, welcome-file-list에 정의된 welcome-file을 순서대로 찾아 기본 페이지로 보여준다.</p><li>실행</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20180929_220302.png" class="w3-round"></div><p>또는 Export » WAR file를 선택하여, 톰캣 webapps 디렉터리에 옮긴 후 배치되기를 기다린 뒤 브라우저에서 실행.</p><li>이클립스 내부에서 실행하는 경우 웹 애플리케이션 배포 위치</li><p>${PROJECT_ROOT}\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps\Web01\WEB-INF</p></ol><h3 class="marker">톰캣에 직접 배치</h3><ol><li>위와 동일하게 HelloWorld.java 작성 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/servlet/Hello1.java" lan="java">Hello1.java »</button></li><li>컴파일</li><ul><li>톰캣 lib를 클래스패스로 넘기는 경우</li><p><strong>↓ shell</strong></p><div lan="shell" class="as-code code-div w3-leftbar w3-border-green">javac -encoding UTF-8 -cp "C:\apache-tomcat-8.0.52\lib\servlet-api.jar" HelloWorld.java</div><li>JDK의 jre/lib/ext에 servlet-api.jar를 붙여넣은 경우</li><p><strong>↓ shell</strong></p><div lan="shell" class="as-code code-div w3-leftbar w3-border-green">javac -encoding UTF-8 HelloWorld.java</div></ul><li>컴파일된 클래스 파일을 webapps/${웹모듈명}/WEB-INF/classes/${패키지 경로}/ 에 저장</li><li>동일한 배포 설명자 web.xml을 WEB-INF에 작성하고 실행 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/webapp/WEB-INF/web.xml" lan="xml">web.xml »</button></li></ol><h3 class="marker">이클립스 Maven 프로젝트</h3><ol><li>New Project » Maven » Maven Project » maven-archetype-webapp</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20180930_154849.png" class="w3-round"></div><p>webapp 아티팩트로 프로젝트를 만들면 Hello World를 출력하는 index.jsp가 생성된다.</p><li>Maven Install, 빌드하여 war 파일이 생성되면 톰캣 webapps 디렉터리에 붙여넣고 배치되기를 기다린 뒤 브라우저에서 실행</li><p>maven이 pom.xml에 정의된 라이브러리를 /users/유저이름/.m2 폴더에 다운로드한다.</p></ol></div><h2 class="marker">서블릿 생애 주기</h2><ol><li>서블릿 컨테이너에 의해 최초로 로드되어 인스턴스 생성</li><li>init()</li><li>각 요청마다 service() 호출</li><li>destroy()</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/servlet/LifeCycle.java" lan="java">View Code »</button></ol><h2 class="marker">web.xml 대신 애너테이션으로 서블릿 기술</h2><ol><li>WebServlet 애너테이션으로 배포설명자 web.xml 대신 간결하게 서블릿을 기술할 수 있다.</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/servlet/Hello2.java" lan="java">value</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/servlet/Hello3.java" lan="java">initParams</button><li>name : 배포설명자의 servlet-name에 해당.</li><li>urlPatterns : 배포설명자의 url-pattern들의 배열에 해당.</li><li>value : urlPatterns 요소와 동일하게 동작하기 때문에, 서블릿 매핑만을 기술할 거라면 편하게 WebServlet("/hello")처럼 기술할 수 있다.</li><li>initParams : 배포설명자의 init-param들의 배열에 해당.</li><p>GenericServlet#getInitParameter로 참조할 수 있으며, 이 메서드는 ServletConfig#getInitParameter를 호출한다. ServletConfig는 GenericServlet#getServletConfig 메서드로 참조할 수 있다.</p><li>loadOnStartup : 컨테이너가 애플리케이션을 시작할 때, 클라이언트의 요청이 없어도 미리 해당 서블릿을 인스턴스화 한다.</li><p>Non-negative 정수로 설정하며, 0에 가까울수록 우선 초기화<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/servlet/Hello5.java" lan="java">loadOnStartup</button></p></ol><h2 class="marker">JDBC 예시</h2><ol><li>드라이버 설치</li><ul><li>톰캣 lib(예. C:\apache-tomcat-8.0.52\lib)에 복사</li><li>또는 웹 애플리케이션 lib(${프로젝트}\WebContent\WEB-INF\lib)에 복사</li><li>또는 프로젝트에 직접 포함</li></ul><li>사용하기 전에 드라이버 클래스 로드</li><li>DataSource 직접 사용하기<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/servlet/Hello4.java" lan="java">View Code »</button></li><ul><li>url : JDBC 연결 문자열로, 옵션은 각 JDBC마다 제공하는 것이 다르다</li><li>위 예시코드에서는 Apache Commons DBCP를 이용. <a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://commons.apache.org/proper/commons-dbcp/guide/index.html">index</a></li><p><strong>↓ java</strong></p><div lan="java" class="as-code code-div w3-leftbar w3-border-green">BasicDataSource.initialSize                 // 최초 커넥션 수 + maxActive, maxIdle, minIdle
BasicDataSource.maxWait                     // 풀에 커넥션이 없을 때 대기하는 최대 시간(ms). 음수면 무기한
BasicDataSource.minEvictableIdleTimeMillis  // 설정된 것 이상 비활성 상태인 커넥션은 정리될 수 있다
                                            // + timeBetweenEvictionRunsMillis, numTestsPerEvictionRun
BasicDataSource.testOnBorrow                // 커넥션을 가져올 때, 유효한 지 검사할 지 여부
                                            // + testOnReturn, testWhileIdle</div></ul><li>context.xml 리소스로 DataSource 정의하기</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/webapp/META-INF/context.xml" lan="xml">context.xml »</button><p><strong>↓ web.xml » resource-ref</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;resource-ref>
    &lt;res-ref-name>jdbc/MySQL/localhost/test</res-ref-name>
    &lt;res-type>javax.sql.DataSource</res-type>
    &lt;res-auth>Container</res-auth>
&lt;/resource-ref></div><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/servlet/Hello6.java" lan="java">서블릿 »</button></ol></div><h1 class="marker">서블릿</h1><div><h2 class="marker">다른 페이지로 이동/호출</h2><ol><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/servlet/CallOther.java" lan="java">View Code »</button><li>다른 페이지로 이동</li><ul><li>Refresh : 응답 페이지를 보여준 뒤 클라이언트가 나중에 다시 요청하도록 한다.</li><li>Redirect : 응답 페이지 없이 바로 다른 url을 요청하도록 한다.</li><p>따라서 redirect의 경우에는 getWriter()를 이용하지 말아야 한다.</p></ul><li>다른 페이지 호출</li><ul><li>Forward</li><ul><li>호출하는 페이지로 제어를 넘기기 때문에 해당 페이지가 종료되도 제어가 되돌아오지 않는다.</li><p>따라서 forward를 호출하는 측은 getWriter()를 이용하지 말아야 한다.
 + 호출자 자신과 동일한 페이지/서블릿을 호출할 수 있다.</p><li>forward는 서버 내에서 요청/응답 객체를 넘겨주므로 별도의 인코딩 없이 텍스트나 다른 객체를 추가하여 넘겨줄 수 있다.</li></ul><li>Include</li><ul><li>Forward와 달리 호출된 페이지가 종료되면 제어가 돌아온다.</li><p>때문에 호출자와 동일한 페이지/서블릿을 호출할 수 없다.</p><li>호출된 페이지와 호출한 페이지 사이의 출력 HTML 코드 조각 순서를 맞추기 위해 flush()를 적절히 호출해줘야 한다.</li></ul></ul></ol><h2 class="marker">필터</h2><ol><li>웹 브라우저가 웹 컴포넌트를 호출하면, 필터가 사전작업을 수행하고 웹 컴포넌트를 호출.</li><li>필터 체인 : 하나의 페이지에 대해 여러 필터가 정의된 경우, 정의된 순서대로 필터가 호출된다.</li><li>배포 설명자에 명시 :<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/webapp/WEB-INF/web.xml" lan="xml">web.xml »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/filter/DoNothing.java" lan="java">View Code »</button></li><li>애너테이션으로 명시 :<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/filter/DoNothing2.java" lan="java">View Code »</button></li></ol><h2 class="marker">래퍼</h2><ol><li>Http 요청/응답을 감싸는 사용자 정의 객체</li><li>각각 HttpServletRequestWrapper, HttpServletResponseWrapper를 상속하면 된다.</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/request/RequestWrapper.java" lan="java">MyRequestWrapper.java »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/java/io/github/donggi/response/ResponseWrapper.java" lan="java">MyResponseWrapper.java »</button></ol><h2 class="marker">JSP</h2><ol><li>JSP 파일은 클라이언트 요청으로 필요해지면 HttpJspPage 인터페이스를 구현한 서블릿 클래스로 컴파일되고, 해당 서블릿이 요청을 처리한다</li><li>JSP 파일의 본문은 HttpJspPage#_jspService 메서드의 본문이 된다.</li><li>HttpJspPage → JspPage → Servlet</li><p>JspPage 인터페이스는 jspInit(), jspDestroy()를 정의한다</p><li>JSP 태그<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app1/src/main/webapp/jsp/Hello.jsp" lan="xml">Hello.jsp »</button></li><ul><li>&lt;%@ %> : 지시자; Directive : page, taglib, include 3종류가 있다</li><li>&lt;% %> : Scriptlet : 일반 자바 코드를 작성하면 된다. _jspService 메서드 안의 코드로, 매개변수를 포함한 아래의 변수들을 참조할 수 있다.</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20190912_191500.png" class="w3-round"></div><li>&lt;%! %> : 선언문; Declaration : 서블릿 클래스의 멤버 정의</li><li>&lt;%= %> : Expression : out#print 또는 out#write에 들어갈 값을 반환하는 문장을 작성하면 된다</li></ul></ol><h2 class="marker">데이터 저장소</h2><ol><li>ServletContext</li><p>애플리케이션 수준 공유 데이터. GenericServlet#getServletContext로 참조할 수 있다. JSP에서는 application 변수.<br>initParams : 앱 초기화 매개변수. 모든 서블릿이 ServletContext#getInitParameter로 참조할 수 있다.</p><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;!-- web.xml -->
&lt;context-param>
    &lt;param-name>name&lt;/param-name>
    &lt;param-value>Context Param&lt;/param-value>
&lt;/context-param></div><li>ServletConfig</li><p>서블릿 수준 공유 데이터. GenericServlet#getServletConfig로 참조할 수 있다. JSP에서는 config 변수.<br>initParams : 서블릿 초기화 매개변수. 서블릿 내에서 GenericServlet#getInitParameter로 참조할 수 있다.</p><li>당연하지만, 서블릿 static 멤버도 서블릿 수준 공유 가능</li><li>HttpSession</li><p>세션 수준 공유 데이터. HttpServletRequest#getSession으로 참조할 수 있다. JSP에서는 session 변수</p><li>ServletRequest</li><p>(클라이언트 요청 처리) 스레드 수준 공유 데이터. 서블릿마다 자동으로 공유되지는 않으며, 직접 전달해야 한다</p><li>각 클라이언트의 요청이 별개의 스레드에서 실행되므로, ThreadLocal이 유용할 수 있다</li><li>JspContext</li><p>_jspService()에서 자동 선언하는 pageContext 지역변수(). JSP 실행하는 동안 유효.</p></ol><h2 class="marker">javax.servlet 이벤트 리스너</h2><p>이벤트 리스너 구현 클래스는 배포 설명자에 서술되거나, @WebListener를 표기하거나, ServletContext#addListener로 등록돼야 한다</p><ul><li>@WebListener 표기 가능 리스너 : ServletContextListener, ServletContextAttributeListener, ServletRequestListener, ServletRequestAttributeListener, HttpSessionListener, HttpSessionAttributeListener, HttpSessionIdListener</li><li>ServletContext#addListener 등록 가능 리스너 : ServletContextAttributeListener, ServletRequestListener, ServletRequestAttributeListener, HttpSessionAttributeListener, HttpSessionIdListener, HttpSessionListener.</li><p>ServletContext 인스턴스가 ServletContainerInitializer#onStartup()으로 설정됐다면 ServletContextListener도 등록 가능</p></ul><table><caption>종류</caption><tr><th>분류</th><th>이벤트</th><th>인터페이스</th><th>메서드</th><th>설명</th></tr><tr><td>웹앱</td><td>ServletContextEvent</td><td>ServletContextListener Since Servlet 2.3</td><td>contextInitialized</td><td>웹앱 초기화</td></tr><tr><td>웹앱</td><td>ServletContextEvent</td><td>ServletContextListener Since Servlet 2.3</td><td>contextDestroyed</td><td>웹앱 종료</td></tr><tr><td>웹앱 속성</td><td>ServletContextAttributeEvent</td><td>ServletContextAttributeListener Since Servlet 2.3</td><td>attributeAdded</td><td>속성 추가</td></tr><tr><td>웹앱 속성</td><td>ServletContextAttributeEvent</td><td>ServletContextAttributeListener Since Servlet 2.3</td><td>attributeRemoved</td><td>속성 제거</td></tr><tr><td>웹앱 속성</td><td>ServletContextAttributeEvent</td><td>ServletContextAttributeListener Since Servlet 2.3</td><td>attributeReplaced</td><td>속성 변경</td></tr><tr><td>요청</td><td>ServletRequestEvent</td><td>ServletRequestListener Since Servlet 2.4</td><td>requestInitialized</td><td>요청이 웹앱 스코프에 진입</td></tr><tr><td>요청</td><td>ServletRequestEvent</td><td>ServletRequestListener Since Servlet 2.4</td><td>requestDestroyed</td><td>요청이 웹앱 스코프를 벗어남</td></tr><tr><td>요청 속성</td><td>ServletRequestAttributeEvent</td><td>ServletRequestAttributeListener Since Servlet 2.4</td><td>attributeAdded</td><td>속성 추가</td></tr><tr><td>요청 속성</td><td>ServletRequestAttributeEvent</td><td>ServletRequestAttributeListener Since Servlet 2.4</td><td>attributeRemoved</td><td>속성 제거</td></tr><tr><td>요청 속성</td><td>ServletRequestAttributeEvent</td><td>ServletRequestAttributeListener Since Servlet 2.4</td><td>attributeReplaced</td><td>속성 변경</td></tr><tr><td>세션</td><td>HttpSessionEvent</td><td>HttpSessionListener Since Servlet 2.3</td><td>sessionCreated</td><td>세션 생성</td></tr><tr><td>세션</td><td>HttpSessionEvent</td><td>HttpSessionListener Since Servlet 2.3</td><td>sessionDestroyed</td><td>세션 폐기</td></tr><tr><td>세션 속성</td><td>HttpSessionEvent</td><td>HttpSessionIdListener Since Servlet 3.1</td><td>sessionIdChanged</td><td>세션 ID 변경</td></tr><tr><td>세션 속성</td><td>HttpSessionBindingEvent</td><td>HttpSessionAttributeListener Since Servlet 2.3</td><td>attributeAdded</td><td>속성 추가</td></tr><tr><td>세션 속성</td><td>HttpSessionBindingEvent</td><td>HttpSessionAttributeListener Since Servlet 2.3</td><td>attributeRemoved</td><td>속성 제거</td></tr><tr><td>세션 속성</td><td>HttpSessionBindingEvent</td><td>HttpSessionAttributeListener Since Servlet 2.3</td><td>attributeReplaced</td><td>속성 변경</td></tr><tr><td>세션 속성</td><td>HttpSessionBindingEvent</td><td>HttpSessionBindingListener</td><td>valueBound</td><td>HttpSessionBindingListener를 구현한 인스턴스가 세션의 setAttribute()로 추가되면 호출</td></tr><tr><td>세션 속성</td><td>HttpSessionBindingEvent</td><td>HttpSessionBindingListener</td><td>valueUnbound</td><td><ul><p>HttpSessionBindingListener를 구현한 인스턴스가</p><li>세션의 removeAttribute()로 제거된 경우</li><li>invalidate()로 세션이 만료된 경우</li><li>시간 초과로 세션이 만료된 경우 호출</li></ul></td></tr><tr><td>요청 스트림</td><td>void</td><td>ReadListener Since Servlet 3.1</td><td>onDataAvailable</td><td>HTTP 요청 데이터 읽기가 가능해지는 시점에 한 번 호출</td></tr><tr><td>요청 스트림</td><td>void</td><td>ReadListener Since Servlet 3.1</td><td>onAllDataRead</td><td>블로킹 없이 모든 요청 데이터를 읽을 수 있을 때 호출</td></tr><tr><td>요청 스트림</td><td>Throwable</td><td>ReadListener Since Servlet 3.1</td><td>onError</td><td>요청 처리에 예외가 발생한 경우 호출</td></tr><tr><td>응답 스트림</td><td>void</td><td>WriteListener Since Servlet 3.1</td><td>onWritePossible</td><td>응답 쓰기가 가능해지는 시점에 한 번 호출</td></tr><tr><td>응답 스트림</td><td>Throwable</td><td>WriteListener Since Servlet 3.1</td><td>onError</td><td>non-blocking 쓰기 중 발생한 예외 처리</td></tr><tr><td>비동기 처리</td><td>AsyncEvent</td><td>AsyncListener Since Servlet 3.0</td><td>onStartAsync</td><td>비동기 작업 시작</td></tr><tr><td>비동기 처리</td><td>AsyncEvent</td><td>AsyncListener Since Servlet 3.0</td><td>onComplete</td><td>비동기 작업 완료</td></tr><tr><td>비동기 처리</td><td>AsyncEvent</td><td>AsyncListener Since Servlet 3.0</td><td>onTimeout</td><td>비동기 작업 시간초과</td></tr><tr><td>비동기 처리</td><td>AsyncEvent</td><td>AsyncListener Since Servlet 3.0</td><td>onError</td><td>비동기 작업 중 예외가 발생</td></tr></table><ul><li>ReadListener 설정 : ServerRequest#getInputStream → ServerInputStream#setReadListener</li><li>WriteListener 설정 : ServerResponse#getOutputStream → ServerOutputStream#setWriteListener</li><li>AsyncListener 설정 : ServletRequest#startAsync → AsyncContext#addListener</li></ul></div><h1 class="marker">MyBatis</h1><div><h2 class="marker">mybatis-config.xml</h2><ol><li>DTD</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"></div><li>ELEMENT configuration (properties?, settings?, typeAliases?, typeHandlers?, objectFactory?, objectWrapperFactory?, reflectorFactory?, plugins?, environments?, databaseIdProvider?, mappers?)</li><li>properties 예</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;properties url="mybatis.properties"/>
&lt;!-- resource : 파일이 클래스 패스에 있는 경우.
     url      : 다른 경로에 있는 경우 --></div><li>로거 settings</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;setting name="logImpl" value=""/>
&lt;!-- value : SLF4J, LOG4J, LOG4J2, JDK_LOGGING, COMMONS_LOGGING, STDOUT_LOGGING, NO_LOGGING, Qualified class path --></div><li>typeAliases : SQL 매퍼 파일의 매개변수/리턴 타입의 별명을 지정</li><p>built-in 별명 : _int(int), int(java.lang.Integer), date(java.util.Date) 등</p><li>environments : 실행 환경(environment) 정의.</li><ul><li>environment » transactionManager » type 속성 : JDBC(MyBatis에서 트랜잭션 관리), MANAGED(서버나 서블릿 컨테이너에서 트랜잭션 관리)</li><li>environment » dataSource » type 속성 : UNPOOLED(매 요청마다 새 커넥션 생성), POOLED(커넥션 풀링), JNDI(서버나 서블릿 컨테이너의 데이터 소스 사용)</li><p><strong>↓ POOLED</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;dataSource type="POOLED">
    &lt;property name="driver" value="org.postgresql.Driver"/>
    &lt;property name="url" value="jdbc:postgresql://localhost:5432/log"/>
    &lt;property name="username" value="name"/>
    &lt;property name="password" value="password"/>
&lt;/dataSource></div><p><strong>↓ JNDI</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;dataSource type="JNDI">
    &lt;property name="data_source" value="jdbc/MySQL/localhost/test"/>
&lt;/dataSource></div></ul><li>mappers : 각 매퍼(mapper) 파일 정의</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;mappers>
    &lt;mapper resource="SomeMapper.xml"/>
    &lt;!-- resource : 파일이 클래스 패스에 있는 경우.
         url      : 다른 경로에 있는 경우 -->
&lt;/mappers></div></ol><h2 class="marker">mapper.xml</h2><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;if test="condition">sql&lt;/if>
&lt;choose> &lt;when test="condition">sql&lt;/when> &lt;otherwise>sql&lt;/otherwise>
&lt;where> &lt;if test="condition">sql&lt;/when> &lt;/where>
&lt;set> &lt;if test="condition">sql&lt;/if> &lt;/set>
&lt;foreach item="item" index...
</div></div><h1 class="marker">Spring Framework</h1><div><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://spring.io/projects/spring-framework#learn">spring-framework#learn</a><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/index.html">spring-framework-reference</a><h2 class="marker">Overview</h2><ul><li>JavaEE 앱 개발을 위한 프레임워크. 다른 JVM 언어(Groovy, Kotlin)도 지원한다.</li><li>Spring Framework 5에 추가된 WebFlux는 서블릿 컨테이너 대신 Netty 등의 리액티브 스트림 서버를 이용한다</li><li>Spring Framework는 순환적인 패키지 참조가 없는, 고도로 표준화된 코드를 유지한다.</li><li>빠른 시작</li><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://start.spring.io/">Spring Boot initializer</a><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://spring.io/guides#topical-guides">topical-guides</a></ul><h2 class="marker">Core</h2><div><h3 class="marker">IoC Container</h3><div><h4 class="marker">Introduction</h4><ul><li>Dependency란?</li><p>객체가 정상적인 작동을 위해 필요로 하는 다른 객체</p><li>IoC(Inversion of Control), DI(Dependency Injection)란?</li><ul><li>객체 인스턴스화, 프로퍼티 설정을 Spring IoC 컨테이너가 대신 해준다.</li><li>의존성을 컨테이너가 주입(DI)한다.</li><li>의존성을 외부에서 설정하므로 제어의 역전(IoC)이 존재한다.</li></ul><li>Bean이란?</li><p>Spring IoC 컨테이너가 관리하는 인스턴스. 그 외 임의 인스턴스를 지칭해도 무방</p><li>연관 패키지</li><p>org.springframework.beans, org.springframework.context</p><li>ApplicationContext → BeanFactory 인터페이스</li><ul><li>BeanFactory : 임의 타입 객체를 관리할 수 있는, DI 관련 최상위 인터페이스.</li><li>ApplicationContext : AOP, 이벤트 발행 등 상용 애플리케이션에 쓰일 특징을 추가로 주입한다.</li></ul></ul><h4 class="marker">Container Overview</h4><p>ApplicationContext는 메타데이터(XML, Java annotation Since 2.5, Java code Since 3.0)에 기술된 대로 클래스를 인스턴스화하고, 의존성을 주입한다.</p><ol><li>IoC 메타데이터 작성</li><li>IoC Container 인스턴스화</li><li>IoC Container 이용</li></ol><div><h5 class="marker">XML 메타데이터</h5><ul><li>ClassPathXmlApplicationContext : 클래스 패스 상의 메타데이터 파일 이용</li><li>FileSystemXmlApplicationContext : 파일 시스템 상의 메타데이터 파일 이용</li><li>WebApplicationContext : web.xml 이용</li></ul><div><h6 class="fake marker">최상위 &lt;beans/> 안에 필요한 &lt;bean/>들을 정의한다</h6><h6 class="fake marker">다른 xml 포함</h6><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;beans>
    &lt;import resource="other.xml"/>
    &lt;import resource="dir/other.xml"/>
&lt;/beans></div><p>↑ resource의 경로는 '/'로 시작하더라도 항상 현재 디렉터리에 대한 상대경로로 해석된다.</p></div><h5 class="marker">Groovy DSL 메타데이터</h5><p><strong>↓ services.groovy</strong></p><div lan="groovy" class="as-code code-div w3-leftbar w3-border-green">beans {
    myService(MyService) {
        msg = "Hello World"
    }
}</div><p><strong>↓ java</strong></p><div lan="java" class="as-code code-div w3-leftbar w3-border-green">var context = new GenericGroovyApplicationContext("services.groovy");</div><h5 class="marker">메타데이터 혼용</h5><p>GenericApplicationContext를 이용하면 종류가 다른 메타데이터들을 혼용할 수 있다</p><p><strong>↓ java</strong></p><div lan="java" class="as-code code-div w3-leftbar w3-border-green">var context = new GenericApplicationContext();
new XmlBeanDefinitionReader(context).loadBeanDefinitions("services.xml", "daos.xml");
new GroovyBeanDefinitionReader(context).loadBeanDefinitions("services.groovy", "daos.groovy");
context.refresh();
</div></div><h4 class="marker">Bean Overview</h4><table class="no-sort"><caption>빈을 정의하는 요소 <a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://docs.spring.io/spring/docs/5.3.0-SNAPSHOT/javadoc-api/org/springframework/beans/factory/config/BeanDefinition.html">BeanDefinition</a></caption><tr><td>Class</td></tr><tr><td>Name</td></tr><tr><td>Scope</td></tr><tr><td>Constructor arguments</td></tr><tr><td>Properties</td></tr><tr><td>Autowiring mode</td></tr><tr><td>Lazy initialization mode</td></tr><tr><td>Initialization method</td></tr><tr><td>Destruction method</td></tr></table><div><h5 class="marker">Naming Beans</h5><ul><li>모든 빈은 이름을 가지며, 지정하지 않더라도 자동 할당된다</li><li>XML에서 빈 이름은 id 또는 name 속성으로 정의할 수 있다</li><p>id는 컨테이너 전체에 걸쳐 고유해야 하며, name은 여러 이름을 ',', ';', ' '로 구분하여 설정할 수 있다</p><li>동일한 빈을 여러 이름으로 접근할 수 있다</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;alias name="originalName" alias="alias1"/>
&lt;alias name="originalName" alias="alias2"/></div></ul><h5 class="marker">Instantiating Beans</h5><ul><li>빈 클래스로 static 클래스 지정 가능</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;bean class="com.example.SomeThing$OtherThing"/></div><li>팩터리 메서드 지정 가능</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;bean class="..." factory-method="newInstance"/>
&lt;bean factory-bean="beanName" factory-method="newInstance"/></div><li>생성된 빈의 실제 타입은 BeanFactory#getType 메서드로 획득할 수 있다</li></ul></div><h4 class="marker">Dependency Injection</h4><ul><li>A가 B에 의존하고, 둘 사이에 순환 의존성이 존재하지 않는다면, A에 B가 주입되기 전에 B가 완전히 초기화됨이 보장된다</li><li class="marker">생성자 주입 // 팩터리 메서드 인자도 동일한 태그를 사용한다</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;constructor-arg index="0" type="java.lang.String" name="msg" value="Hell World"/>
&lt;constructor-arg value="Hell World"/>
&lt;constructor-arg ref="beanName"/>
&lt;constructor-arg>
    &lt;ref bean="beanName"/>
&lt;/constructor-arg></div><ul><li>index, type, name은 모호성을 피하기 위해 사용하는 옵션 프로퍼티이며, name을 이용하는 경우 debug 컴파일하거나, <a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://docs.oracle.com/javase/8/docs/api/java/beans/ConstructorProperties.html">ConstructorProperties</a>를 이용해 이름을 탐색할 수 있게 해야한다.</li><li>constructor-arg를 이용한 생성자 주입 예</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello17.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans25.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello17Test.java" lan="java">Context</button><li>xmlns:c를 이용한 생성자 주입 예</li><ul><li>생성자 인자 이름을 알 수 있는 경우 예 : <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello17.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans26.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello17Test2.java" lan="java">Context</button></li><li>생성자 인자 이름을 알 수 없는 경우 예 : <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello17.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans32.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello17Test4.java" lan="java">Context</button></li></ul></ul><li class="marker">세터 주입</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;property name="message" value="Hello"/>
&lt;property name="message" ref="beanName"/>
&lt;property name="message">
    &lt;ref bean="beanName"/>
&lt;/property>
&lt;property name="message">
    &lt;bean class="java.lang.String" c:original="빈 메시지 2"/>
&lt;/property></div><ul><li>인자 없는 생성자 또는 팩터리 메서드 호출 뒤, 세터를 호출하여 의존성을 주입한다</li><li>property를 이용한 세터 주입 예</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello1.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans1.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello1Test.java" lan="java">Context</button><li>p(property) xmlns:p를 이용한 세터 주입 예</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello1.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans5.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello1Test2.java" lan="java">Context</button></ul><li class="marker">기타 의존성 주입</li><table><tr><th>종류</th><th>예시 코드</th></tr><tr><td>익명 빈 생성</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello17.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans27.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello17Test3.java" lan="java">Context</button></td></tr><tr><td>의존 빈 주입</td><td>property, constructor-arg 태그 안에서 이용하는 bean 태그들은 id, name이 필요없으며, 지정해도 무시된다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello1.java" lan="java">Bean1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello17.java" lan="java">Bean2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans7.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello4Test3.java" lan="java">Context</button></td></tr><tr><td>의존 컬렉션 주입</td><td>자바 기본 타입 및 String은 문자열로부터 알아서 변환되어 주입된다.
 반면 배열, List, Properties, Map 등은 전용 태그를 이용하거나, 다른 팩터리 메서드를 빌려 설정해야 한다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello5.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans8.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello5Test.java" lan="java">Context</button></td></tr><tr><td>팩터리를 통한 의존 컬렉션 주입</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello5.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans10.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello5Test3.java" lan="java">Context</button></td></tr><tr><td>xmlns:util을 이용한 의존 컬렉션 주입</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello5.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans9.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello5Test2.java" lan="java">Context</button></td></tr><tr><td>parent 속성을 통한 상속</td><td><p>값 상속 예 : <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello1.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans11.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello1Test3.java" lan="java">Context</button></p><p>컬렉션 상속(merge="true") 예 : <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello5.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans31.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello5Test4.java" lan="java">Context</button></p></td></tr><tr><td>parent context를 이용한 상속</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello18.java" lan="java">Interface</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello18Impl.java" lan="java">Impl</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans29.xml" lan="xml">parent XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans30.xml" lan="xml">child XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello18Test.java" lan="java">Context</button></td></tr><tr><td>lookup-method를 통한 프록시</td><td><ul><span id="pos-516828012" style="padding:0!important;margin:0!important;width:0!important;height:0!important;overflow:hidden!important"></span><li>name : 재정의할 메서드 이름 → private X, void 반환 X, 메서드 매개변수 X, final X</li><li>bean : 재정의한 메서드에서 반환할 객체</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans19.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Beans19Test.java" lan="java">Context</button></ul></td></tr><tr><td>replaced-method를 통한 프록시</td><td><ul><li>name : 재정의할 메서드 이름</li><li>replacer : MethodReplacer 구현체</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello22.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello22Replacement.java" lan="java">MethodReplacer</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans36.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello22Test.java" lan="java">Context</button></ul></td></tr><tr><td>Compound property name을 이용한 내부 빈 속성 설정</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello19.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans33.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello19Test.java" lan="java">Context</button></td></tr><tr><td><span id="pos-25936411" style="padding:0!important;margin:0!important;width:0!important;height:0!important;overflow:hidden!important"></span>depends-on을 이용한 빈 생성 순서 설정</td><td>has-a 관계보다 약한 의존 관계에서, depends-on을 이용해 특정 빈이 먼저 생성되도록 강제할 수 있다.
 양쪽 빈 모두 싱글톤인 경우, 객체 소멸 순서도 정해진다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello20.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans34.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello20Test.java" lan="java">Context</button></td></tr><tr><td>lazy-init을 이용한 빈 생성 늦추기</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello21.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans35.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello21Test.java" lan="java">Context</button></td></tr></table></ul><div><h5 class="marker">Autowire</h5><ul><li>IoC 컨테이너가 관리중인 빈들을 자동으로 주입하도록 구성할 수 있다. XML에서는 bean 태그의 autowire 속성으로 제어하며, 아래 4가지 모드가 가능하다</li><table><tr><th>mode</th><th>설명</th></tr><tr><td>no</td><td>기본 설정. 모든 의존성은 명시되어야 한다.</td></tr><tr><td>byName</td><td>이름이 일치하는 빈을 주입한다</td></tr><tr><td>byType</td><td>타입이 일치하는 빈을 주입한다. 일치하는 빈이 2개 이상이면 에러, 0개면 미설정</td></tr><tr><td>constructor</td><td>생성자에 적용되는 byType</td></tr></table><li>명시된 의존성은 항상 autowire보다 우선이며, 자바 기본 타입은 autowire 할 수 없다.</li><li>bean 정의 시 autowire-candidate 속성을 false로 하면, type 매치 주입물이 되지 않는다</li><li>beans 정의 시 default-autowire-candidates를 이용해 autowire 주입물을 제한할 수 있다</li><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;beans ... default-autowire-candidates="*Service,*Dao" /></div><li>bean 정의 시 primary 속성을 true로 하면, 최우선 autowire 주입물이 된다</li><li>예시 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello15.java" lan="java">Bean1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello16.java" lan="java">Bean2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans12.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello15Test3.java" lan="java">Context</button></li></ul></div><h4 class="marker">Bean Scope</h4><ul><li>빈의 유효 기간을 설정할 수 있다. 아래 6가지는 빈 설정 시 기본으로 이용할 수 있는 목록이다.</li><table><tr><th>Scope</th><th>설명</th></tr><tr><td>singleton</td><td>기본값. 컨테이너에서 하나의 인스턴스만 생성</td></tr><tr><td>prototype</td><td>빈 요청마다 새 인스턴스 생성. 컨테이너는 prototype 빈의 일부 lifecycle만 관리하며, 생성 이후 lifecycle은 클라이언트가 책임져야 한다</td></tr><tr><td>request</td><td>HTTP 요청마다 새 인스턴스 생성. Web 관련 ApplicationContext에서 지정 가능</td></tr><tr><td>session</td><td>HTTP 세션마다 새 인스턴스 생성. Web 관련 ApplicationContext에서 지정 가능</td></tr><tr><td>application</td><td>ServletContext마다 새 인스턴스 생성. Web 관련 ApplicationContext에서 지정 가능</td></tr><tr><td>websocket</td><td>WebSocket마다 새 인스턴스 생성. Web 관련 ApplicationContext에서 지정 가능</td></tr></table><li>Spring 3.0부터 스레드 단위로 인스턴스를 생성하는 SimpleThreadScope가 추가되었다.</li><p>ConfigurableBeanFactory.registerScope(String, Scope) 또는 CustomScopeConfigurer로 사용 가능</p><span id="pos1923990332" style="padding:0!important;margin:0!important;width:0!important;height:0!important;overflow:hidden!important"></span><li>request, session, application 예</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/entity/PerApp.java" lan="java">Bean per App</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/entity/PerRequest.java" lan="java">Bean per Request</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/entity/PerSession.java" lan="java">Bean per Session</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/controller/ScopeController.java" displayRange="[27,55]" lan="java">Controller</button><li>기본적으로 빈에 주입된 의존 객체는 컨테이너에 의해 다시 설정되지 않는다.</li><p>만일 스코프가 더 좁은 빈을 의존하지만 참조 시마다 새로운 인스턴스가 필요한 경우, 해당 메서드를 재정의하거나, aop:scoped-proxy를 이용하면 된다.
 AOP proxy 인스턴스는 직렬화 가능하며, 직렬화 전 참조 객체와 역직렬화 후 참조 객체는 동일하다.</p><p>다른 방법으로 ObjectFactory#getObject(), ObjectProvider(→ ObjectFactory)의 getIfAvailable(), getIfUnique()을 이용할 수도 있다</p><p><span template-id="template-jsr330" class="hover-content">JSR-330</span>에서는 Provider가 위와 비슷한 기능을 제공한다.</p><table class="no-sort"><tr><td>아무 설정 없는 예</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello15.java" lan="java">Bean1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello16.java" lan="java">Bean2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans20.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello15Test.java" lan="java">Context</button></td></tr><tr><td>메서드 재정의 예</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello15.java" lan="java">Bean1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello16.java" lan="java">Bean2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans37.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello15Test5.java" lan="java">Context</button></td></tr><tr><td>aop:scoped-proxy 예</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello15.java" lan="java">Bean1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello16.java" lan="java">Bean2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans21.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello15Test4.java" lan="java">Context</button></td></tr><tr><td>Custom Scope 예</td><td><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/entity/PerMinute.java" lan="java">Bean per Minute</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/scope/MinuteScope.java" lan="java">Custom Scope</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/config/MinuteBeanFactoryPostProcessor.java" lan="java">PostBeanProcessor</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/config/AppConfig.java" lan="java">AppConfig</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/controller/ScopeController.java" displayRange="[57,70]" lan="java">Controller</button><p>aop:scoped-proxy 설정을 하고 싶다면 @Scope의 proxyMode 변수를 설정</p><ul><li>NO : default. 프록시 없음</li><li>INTERFACES : 인터페이스 프록시 생성. JDK 동적 프록시 이용</li><li>TARGET_CLASS : 클래스 프록시 생성. CGLIB 이용</li></ul></td></tr></table></ul><h4 class="marker">Bean 커스터마이징</h4><div><h5 class="marker">Lifecycle Callback</h5><ul><li>InitializingBean, DisposableBean 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello2.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans2.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello2Test.java" lan="java">Context</button></li><li>Lifecycle 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello29.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans46.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello29Test.java" lan="java">Context</button></li><li>init-method, destroy-method 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello3.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans3.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello3Test.java" lan="java">Context</button></li><li>destroy-method로 (inferred)를 설정하면 public close() 또는 shutdown()을 찾아 실행한다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello23.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans38.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello23Test.java" lan="java">Context</button></li><li>default-init-method, default-destroy-method 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello24.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans39.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello24Test.java" lan="java">Context</button></li><li>JSR-250 : @PostConstruct, @PreDestroy 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno21.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno21Test.java" lan="java">Context</button></li><li>위 설정들은 중복이 가능하며, 서로 다른 메서드들로 설정된 경우 아래 순서대로 실행된다</li><ul><li>@PostConstruct → InitializingBean → init-method</li><li>@PreDestroy → DisposableBean → destroy-method</li></ul><li>ConfigurableApplicationContext#registerShutdownHook 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello4Test.java" lan="java">Context</button></li></ul><h5 class="marker">Aware</h5><ul><li>ApplicationContextAware 인터페이스를 구현한 경우, 빈 생성 후 어떤 컨텍스트가 만들었는지 알 수 있다. <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello25.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans40.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello25Test.java" lan="java">Context</button></li><li>BeanNameAware 인터페이스를 구현한 경우, 빈 생성 후 어떤 이름으로 만들었는지 알 수 있다. <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello26.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans41.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello26Test.java" lan="java">Context</button></li></ul><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aware-list">aware-list</a><table><tr><th>interface</th><th>주입물</th></tr><tr><td>ApplicationEventPublisherAware</td><td>ApplicationEventPublisher</td></tr><tr><td>BeanClassLoaderAware</td><td>ClassLoader</td></tr><tr><td>BeanFactoryAware</td><td>BeanFactory</td></tr><tr><td>LoadTimeWeaverAware</td><td>LoadTimeWeaver</td></tr><tr><td>MessageSourceAware</td><td>MessageSource</td></tr><tr><td>ResourceLoaderAware</td><td>ResourceLoader</td></tr><tr><td>ServletConfigAware</td><td>ServletConfig</td></tr><tr><td>ServletContextAware</td><td>ServletContext</td></tr></table></div><h4 class="marker">컨테이너 확장</h4><p>ApplicationContext를 직접 상속하지 않고, 여러 인터페이스 구현체를 등록함으로써 기능 확장이 가능하다.</p><ul><li>BeanPostProcessor <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello27.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans42.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello27Test.java" lan="java">Context</button></li><p>인스턴스 생성 후, 초기화 콜백 호출 전/후 작업을 추가할 수 있다. 여러 BeanPostProcessor를 등록하는 경우, order 속성(Ordered 인터페이스)으로 실행 순서를 제어할 수 있다.</p><p>ApplicationContext#addBeanPostProcessor를 이용해 직접 등록하는 경우, Ordered 인터페이스를 구현해도 무시하며, 직접 등록된 순서대로 실행된다. 자동으로 탐색된 다른 BeanPostProcessor들보다 항상 먼저 실행된다.</p><li>BeanFactoryPostProcessor</li><p>빈을 생성하기 전에 컨테이너 관련 설정을 변경할 수 있다. 여러 BeanFactoryPostProcessor를 등록하는 경우, order 속성(Ordered 인터페이스)으로 순서를 제어할 수 있다</p><ul><li>PropertySourcesPlaceholderConfigurer 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello1.java" lan="java">Bean1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello17.java" lan="java">Bean2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans43.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/beans43-1.properties" lan="ini">properties1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/beans43-2.properties" lan="ini">properties2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello17Test5.java" lan="java">Context</button></li><li>PropertyOverrideConfigurer 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello1.java" lan="java">Bean1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello17.java" lan="java">Bean2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans44.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/beans43-1.properties" lan="ini">properties1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/beans43-2.properties" lan="ini">properties2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/beans44.properties" lan="ini">properties3</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello17Test6.java" lan="java">Context</button></li></ul><li>FactoryBean<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/bean/Hello28.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/Beans45.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/bean/Hello28Test.java" lan="java">Context</button></li><p>빈 생성 절차를 XML보다 Java로 표현하는 것이 효율적인 경우, FactoryBean을 컨테이너에 등록할 수 있다</p></ul><h4 class="marker">Annotation 기반 설정</h4><ul><li>XML 기반 설정과 같이 이용하는 경우, Annotation 기반 처리가 먼저 이뤄짐에 유의.</li><li>context:annotation-config <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/anno01.xml" lan="xml">XML</button></li><p>↑ 컨테이너에 등록된 빈에 대하여 애너테이션 처리</p><li>context:component-scan <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/anno02.xml" lan="xml">XML</button></li><p>↑ 기준 패키지의 모든 클래스를 탐색하여 자동으로 빈 등록, DI, 기타 애너테이션 처리</p><li>XML을 아예 사용하지 않고도 구성 가능하다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno02.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno02Test2.java" lan="java">Context</button></li><li>@Autowired, @Inject, @Value, @Resource는 BeanPostProcessor 구현체가 처리하므로, 사용자 정의 BeanPostProcessor 또는 BeanFactoryPostProcessor 클래스 안에서 해당 애너테이션들을 적용할 수 없다. 대신 @Bean을 이용해야 한다.</li><li>Since JDK 9 : 스캔 대상 패키지가 module-info에서 exports 됐는지, non-public 메서드를 호출해야 되는 패키지가 opens(exports 말고) 됐는지 확인 필요</li></ul><table><tr><th>Annotation</th><th>대응 코드</th><th>예시 코드</th></tr><tr><td>@Component</td><td>xml: bean</td><td><ul><li>해당 타입이 빈 생성 대상임을 나타낸다</li><li>value로 빈 이름을 설정할 수 있다. ""(default)면 자동 할당</li><li>@Repository : Persistence layer</li><li>@Service : Service layer</li><li>@Controller : Presentation layer</li><li>@Configuration : @Bean 메서드들을 갖는 구성 클래스</li><p>@Configuration 클래스 안에서 형제 @Bean 메서드 호출은 의존 관계의 정의를 의미한다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno26.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno26Test.java" lan="java">Context</button></p><li>@RestController = @Controller + @ResponseBody</li><li>기타 사용자 정의 애너테이션도 가능</li></ul></td></tr><tr><td>@Bean</td><td>xml: bean</td><td><ul><li>팩터리 메서드에 적용하여 빈 생성 대상임을 나타낸다</li><li>static 메서드에 적용하는 경우 프록시를 통하지 않고 호출된다</li><li>name으로 빈 별명을 설정할 수 있다</li><li>initMethod를 설정할 수 있다 ← 메서드 바디에서 호출하면 되므로 쓸 일은 별로 없을듯</li><li>destroyMethod를 설정할 수 있다</li><p>기본값은 "(inferred)"로, 자동으로 public close() 또는 shutdown()을 찾아 실행한다. 아무것도 호출하고 싶지 않다면 ""로 설정하면 된다.</p><p>JNDI로 가져온 리소스 ─ 특히 DataSource들은 외부에서 생애가 관리되므로 destroyMethod="" 설정함이 바람직하다</p></ul></td></tr><tr><td>@Conditional</td><td></td><td>Condition 인터페이스 구현체를 지정하여, @Component, @Configuration, @Bean 초기화를 진행할 지 여부를 미리 판단한다</td></tr><tr><td><span id="pos1225939273" style="padding:0!important;margin:0!important;width:0!important;height:0!important;overflow:hidden!important"></span>@Profile</td><td>xml: beans profile=""</td><td>@Conditional(value=org.springframework.context.annotation.ProfileCondition.class) → active profile을 기준으로 판단한다<a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="#pos230028222" target="_self">Goto - profile 표현식</a></td></tr><tr><td>@Autowired</td><td>xml: autowire</td><td><ul><li>적용 위치 : CONSTRUCTOR, FIELD, METHOD, PARAMETER</li><li>CONSTRUCTOR 적용 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno03.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno03Test.java" lan="java">Context</button></li><p>Since 4.3 : 기본 생성자가 없으면서 여러 생성자가 존재하는 경우에만 생성자에 @Autowired 적용 필요</p><li>FIELD 적용 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno01.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/anno01.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno01Test.java" lan="java">Context</button></li><li>특정 타입 T의 배열(T[])/컬렉션(Collection&lt;T>)/맵(Map&lt;String, T>에 적용한 경우, 해당 타입의 모든 빈을 목록으로 설정해준다.</li><p>타깃 타입이 org.springframework.core.Ordered를 구현했거나, @Order, @Priority를 갖고 있으면 정렬하여 설정해준다</p><ul><li>Array FIELD 적용 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno02.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno02Test.java" lan="java">Context</button></li><li>Set FIELD 적용 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno05.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno05Test.java" lan="java">Context</button></li><li>Map FIELD 적용 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno06.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno06Test.java" lan="java">Context</button></li></ul><li>required = false</li><ul><li>FIELD, METHOD에 required = false 적용 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno07.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno07Test.java" lan="java">Context</button></li><p>의존 객체가 하나라도 누락되면 호출을 생략한다. → 따라서 기본값 그대로 남는다.</p><li>팩터리 메서드, CONSTRUCTOR에 required = false 적용</li><p>배열, Collection, Map인자로 매칭되는 빈이 없는 경우, empty 인스턴스를 넘겨 호출한다.</p><li>↑ 이는 @Autowired가 없는 단일 생성자를 갖는 일반 클래스에도 적용된다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno08.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno08Test.java" lan="java">Context</button></li></ul><li>METHOD 적용 예 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno04.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno04Test.java" lan="java">Context</button></li><li>인자가 있든 없든 호출되길 원한다면 Optional 또는 @Nullable(Since 5.0)을 이용하면 된다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno09.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno09Test.java" lan="java">Context</button></li><li>아래의 인터페이스 및 연관 구현 클래스에 대한 @Autowired 필드는 실행 환경에 따라 적절히 주입된다.</li><p>BeanFactory, ApplicationContext, Environment, ResourceLoader, ApplicationEventPublisher, MessageSource</p></ul></td></tr><tr><td>@Primary</td><td>xml: primary="true"</td><td>특정 빈을 우선적으로 주입하도록 설정한다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno10.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno10Test.java" lan="java">Context</button></td></tr><tr><td>@Qualifier</td><td>xml: qualifier value="xxx"<br>xml: qualifier type="x.y.Z" value="xxx"</td><td><ul><li>빈을 구별할 수 있는 값을 설정한다. 빈 이름은 default qualifier로 이용됨에 유의. <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno11.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno11Test.java" lan="java">Context</button></li><li>Qualifier는 고유할 필요가 없으며, 배열/컬렉션/맵 주입 시 qualifier가 일치하는 모든 빈들이 멤버로 할당된다</li><li>@Autowired와 같이 사용하는 경우, 타입 기반 매칭이 먼저 수행됨에 유의. Qualifier 매칭만 수행하려는 경우 JSR-250의 @Resource를 이용할 것.</li><li>사용자 정의 @Qualifier를 이용할 수 있다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno12.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno12Test.java" lan="java">Context</button></li><li>사용자 정의 @Qualifier는 값 없이도 빈 특정이 가능할 수 있다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno13.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno13Test.java" lan="java">Context</button></li><li>사용자 정의 @Qualifier는 다른 타입 속성들을 가질 수 있다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno14.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno14Test.java" lan="java">Context</button></li><li>Generic도 일종의 타입 Qualifier로 이용할 수 있다<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno15.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno15Test.java" lan="java">Context</button></li></ul></td></tr><tr><td>@Resource</td><td>xml: ref="beanName"</td><td><ul><li>빈 이름을 기준으로 주입한다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno16.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno16Test.java" lan="java">Context</button></li><li>name 속성을 지정하지 않으면 field 또는 parameter 이름을 기준으로 찾는다</li><li>이름을 기준으로 찾지 못하면 타입을 기준으로 다시 찾는다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno17.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno17Test.java" lan="java">Context</button></li></ul></td></tr><tr><td>@Value</td><td>xml: context:property-placeholder</td><td><ul><li>외부 *.properties 파일 기반으로 값 주입<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno18.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/anno18.properties" lan="ini">properties</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno18Test.java" lan="java">Context</button></li><li>@Bean static 메서드로 PropertySourcesPlaceholderConfigurer 인스턴스를 반환하면 커스터마이징 가능하다</li><li>Spring Boot 애플리케이션은 기본적으로 application.properties, application.yml 파일을 읽는 PropertySourcesPlaceholderConfigurer 빈을 갖는다</li><li>프로퍼티 문자열 → Java Type으로의 변환</li><p>BeanPostProcessor는 ConversionService를 이용해 타입 변환을 수행한다. 커스텀 컨버터를 등록하면 사용자 정의 타입으로의 변환도 가능하다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno19.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/anno19.properties" lan="ini">properties</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno19Test.java" lan="java">Context</button></p><li>SpEL 표현식도 가능하다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno20.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno20Test.java" lan="java">Context</button></li></ul></td></tr><tr><td>@PostConstruct</td><td>xml: init-method</td><td>빈 생성 후 호출 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno21.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno21Test.java" lan="java">Context</button></td></tr><tr><td>@PreDestroy</td><td>xml: destroy-method</td><td>빈 소멸 시 호출<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno21.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno21Test.java" lan="java">Context</button></td></tr><tr><td>@ComponentScan</td><td>xml: context:component-scan base-package=""</td><td><ul><li>스캔 범위를 확장한다 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno22.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/rare/Rare1.java" lan="java">Bean</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno22Test.java" lan="java">Context</button></li><li>includeFilters == xml: context:include-filter </li><p>↑ 명시적으로 매칭되는 클래스만 스캔</p><li>excludeFilters == xml: context:exclude-filter</li><p>↑ 매칭되는 클래스는 스캔 제외</p><li>useDefaultFilters=false == xml: use-default-filters="false"</li><p>↑ @Component, @Repository, @Service 등을 자동으로 찾지 않는다.</p><li>필터 종류</li><ul><li>annotation(default) : 타입에 특정 애너테이션이 붙어있는지? <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno23.java" lan="java">Configuration</button></li><li>assignable : 특정 타입으로 할당 가능한지? <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno23.java" lan="java">Configuration</button></li><li>aspectj : 클래스 경로가 AspectJ 표현식에 일치하는지? <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno24.java" lan="java">Configuration</button></li><p><strong>↓ AspectJ 관련 jar들을 포함해야 한다. Spring Boot 예</strong></p><div lan="gradle" class="as-code code-div w3-leftbar w3-border-green">implementation 'org.springframework.boot:spring-boot-starter-aop'</div><li>regex : 클래스 경로가 정규표현식에 일치하는지? <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno24.java" lan="java">Configuration</button></li><li>custom : TypeFilter 구현 클래스 지정 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno25.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/scan/ScanFilter.java" lan="java">TypeFilter</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno25Test.java" lan="java">Context</button></li></ul><li>nameGenerator == xml: name-generator</li><p>스프링 기본 네이밍이 맞지 않는 경우 BeanNameGenerator 구현체를 직접 제공해도 된다. 특히 같은 이름의 클래스가 여러 패키지에 존재하는 경우, 클래스 풀네임을 이름으로 제공하는 FullyQualifiedAnnotationBeanNameGenerator(Since 5.2.3)도 고려해봄직하다.</p><li>scopeResolver == xml: scope-resolver</li><p>애너테이션 기반 스코핑이 불충분하다면, 직접 ScopeMetadataResolver 구현체를 제공할 수 있다.</p><li>scopedProxy == xml: scoped-proxy</li><p>singleton 외 스코프 빈에 대한 기본 프록시 설정 가능.</p><ul><li>NO : default. 프록시 없음</li><li>INTERFACES : 인터페이스 프록시 생성. JDK 동적 프록시 이용</li><li>TARGET_CLASS : 클래스 프록시 생성. CGLIB 이용</li></ul></ul></td></tr><tr><td>@Inject</td><td>@Autowired</td><td><span template-id="template-jsr330" class="hover-content">JSR-330</span><ul><li>@Autowire와 마찬가지로 필드, 메서드, 생성자에 적용 가능 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/jsr330/Anno01.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/jsr330/Anno01Test.java" lan="java">Context</button></li><li>@Named로 이름 지정 가능 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/jsr330/Anno02.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/jsr330/Anno02Test.java" lan="java">Context</button></li><p>@Named는 주입/생성 빈 이름 모두에 사용할 수 있다</p><li>Provider를 이용하여 지연된 접근, 짧은 scope 빈 접근 가능 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/jsr330/Anno03.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/jsr330/Anno03Test.java" lan="java">Context</button></li><li>Optional 또는 @Nullable도 사용 가능 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/jsr330/Anno04.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/jsr330/Anno04Test.java" lan="java">Context</button></li></ul></td></tr><tr><td>@Named, @ManagedBean</td><td>@Component</td><td> <span template-id="template-jsr330" class="hover-content">JSR-330.</span> 타입에 적용하는 경우 자동 생성 대상임을 나타낸다. 속성으로 이름을 지정하지 않는 경우 자동으로 할당된다.</td></tr><tr><td>@Singleton</td><td>@Scope("singleton")</td><td> <span template-id="template-jsr330" class="hover-content">JSR-330</span>의 기본 scope는 prototype이지만, 스프링 컨테이너는 singleton으로 처리한다. 따라서 이 애너테이션은 사용자 정의 스코프 정의에만 이용하면 된다.</td></tr><tr><td>@Qualifier, @Named</td><td>@Qualifier</td><td> <span template-id="template-jsr330" class="hover-content">JSR-330.</span> javax.inject.Qualifier는 사용자 정의 Qualifier를 위해 존재하며, @Named는 String qualifier 구현체로 이용할 수 있다.</td></tr><tr><td>@Import, @ImportResource</td><td>xml: import</td><td><ul><li>@Import : @Configuration에서 다른 @Configuration 임포트 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno27.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno27Test.java" lan="java">Context</button></li><p><strong>↓ java</strong></p><div lan="java" class="as-code code-div w3-leftbar w3-border-green">@Configuration
@Import({OtherConfiguration.class})
public class MyConfiguration {}</div><li>@ImportResource : @Configuration 다른 xml 임포트 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/java/io/github/donggi/anno/Anno28.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/main/resource/anno28.xml" lan="xml">XML</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/app2/src/test/java/io/github/donggi/anno/Anno28Test.java" lan="java">Context</button></li><p><strong>↓ java</strong></p><div lan="java" class="as-code code-div w3-leftbar w3-border-green">@Configuration
@ImportResource("file:src/main/resource/otherConfig.xml")
public class MyConfiguration {}

@Configuration
@ImportResource("classpath:/otherConfig.xml")
public class MyConfiguration {}</div><li>xml에서 @Configuration 임포트는 context:component-scan, context:component-scan 또는 그냥 bean 이용</li></ul></td></tr><tr><td>@DependsOn</td><td>xml: depends-on</td><td><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="#pos-25936411" target="_self">Goto - depends-on</a></td></tr><tr><td>@lookup</td><td>xml: lookup-method</td><td><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="#pos-516828012" target="_self">Goto - lookup-method</a></td></tr><tr><td>@RequestScope</td><td>xml: scope="request"</td><td><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="#pos1923990332" target="_self">Goto - scope 예</a></td></tr><tr><td>@SessionScope</td><td>xml: scope="session"</td><td><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="#pos1923990332" target="_self">Goto - scope 예</a></td></tr><tr><td>@ApplicationScope</td><td>xml: scope="application"</td><td><a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="#pos1923990332" target="_self">Goto - scope 예</a></td></tr><tr><td>@Description</td><td>xml: description</td><td>빈에 대한 설명(Optional)</td></tr><tr><td>@EnableLoadTimeWeaving</td><td>xml: context:load-time-weaver</td><td>LoadTimeWeaverAware를 구현한 빈은 LoadTimeWeaver 인스턴스를 인자로 받는다<a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="#pos-941319825" target="_self">Goto - Spring AOP</a></td></tr></table><h4 class="marker">Environment</h4><ul><li>Environment 인터페이스는 profile, properties 정보를 컨테이너에 제공한다</li><span id="pos230028222" style="padding:0!important;margin:0!important;width:0!important;height:0!important;overflow:hidden!important"></span><li>Profile 표현에 !(not), &amp;(and), |(or) 가능. <a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="#pos1225939273" target="_self">Goto - @Profile</a></li><p>예. production &amp; (us-east | eu-central)<br>xml 표현식에서 !는 가능하지만 &amp;, |는 포함할 수 없다. 대신 beans profiles=""를 중첩하여 &amp; 효과를 얻을 수는 있다</p><li>Profile 활성화</li><p><strong>↓ java</strong></p><div lan="java" class="as-code code-div w3-leftbar w3-border-green">context.getEnvironment().setDefaultProfiles("profile1", "profile2")
context.getEnvironment().setActiveProfiles("profile1", "profile2")</div><p><strong>↓ shell</strong></p><div lan="shell" class="as-code code-div w3-leftbar w3-border-green">$ env "spring.profiles.active=profile1,profile2"</div><p><strong>↓ shell</strong></p><div lan="shell" class="as-code code-div w3-leftbar w3-border-green">$ java ... -Dspring.profiles.active="profile1,profile2"</div><li>제공할 수 있는 properties 타입</li><p>properties 파일, JNDI, Servlet context parameter, Properties 인스턴스, Map 인스턴스</p><li>StandardEnvironment(→ AbstractEnvironment) 기본 포함 properties</li><p>JVM system properties (System.getProperties()) + 환경 변수 (System.getenv()). 시스템 속성이 환경 변수보다 우선 검색된다</p><li>StandardServletEnvironment(→ StandardEnvironment) 추가 제공 properties</li><p>Servlet config + Servlet context parameter + JndiPropertySource(Optional).<br>우선 순위 : ServletConfig ← ServletContext parameter ← JNDI ← JVM system properties ← 환경 변수</p><li>PropertySource 추가</li><p><strong>↓ 수동 추가</strong></p><div lan="java" class="as-code code-div w3-leftbar w3-border-green">var sources = context.getEnvironment().getPropertySources();
sources.addFirst(new PropertySourceA(...));
sources.addLast(new PropertySourceB(...));</div><p><strong>↓ 자동 추가</strong></p><div lan="java" class="as-code code-div w3-leftbar w3-border-green">@Configuration
@PropertySource("classpath:io/github/donggi/${spring.profiles.active:localhost}.properties")
@PropertySource("classpath:io/github/donggi/more/${spring.profiles.active:localhost}.properties")
public class AppConfig {}
</div></ul><h4 class="marker">ApplicationContext 추가 기능</h4><div><h5 class="marker">국제화; ApplicationContext → MessageSource</h5><ul><li>HierarchicalMessageSource 인터페이스는 부모의 것을 상속한다</li><li>문자열 획득</li><p><strong>↓ java</strong></p><div lan="java" class="as-code code-div w3-leftbar w3-border-green">String getMessage(String code, Object[] args[, String default], Locale loc)
String getMessage(MessageSourceResolvable resolvable, Locale locale)</div><li>MessageSource 탐색</li><ol><li>ApplicationContext는 자동으로 "messageSource" 이름의 MessageSource 빈을 찾는다</li><li>없는 경우 부모 컨텍스트에서 해당하는 빈을 찾는다</li><li>없는 경우 DelegatingMessageSource 인스턴스로 설정</li></ol><li>MessageSource 구현체 : ResourceBundleMessageSource, StaticMessageSource</li><li>*.properties 네이밍 규칙</li><ul><li>Locale ENGLISH = createConstant("en", ""); → xxx_en.properties</li><li>Locale US = createConstant("en", "US"); → xxx_en_US.properties</li></ul><li>예시 코드 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/config/I18nConfig.java" lan="java">Configuration</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/resources/i18n/templates_en.properties" lan="ini">templates_en.properties</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/resources/i18n/templates_ko.properties" lan="ini">templates_ko.properties</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/test/java/io/github/donggi/example/config/I18nTests.java" lan="java">Test</button></li></ul><h5 class="marker">이벤트 Pub/Sub</h5><ul><li>이벤트 정의 : ApplicationEvent</li><li>이벤트 리스너 : ApplicationListener 또는 @EventListener(Since 4.2)</li><li>내장 이벤트</li><table><tr><th>Event</th><th>요약</th></tr><tr><td>ContextRefreshedEvent</td><td>ApplicationContext 초기화 또는 갱신(refresh) 완료</td></tr><tr><td>ContextStartedEvent</td><td>ConfigurableApplicationContext#start()</td></tr><tr><td>ContextStoppedEvent</td><td>ConfigurableApplicationContext#stop()</td></tr><tr><td>ContextClosedEvent</td><td>ConfigurableApplicationContext#close() 또는 JVM 종료</td></tr><tr><td>RequestHandledEvent</td><td>HTTP 요청 처리 완료</td></tr><tr><td>ServletRequestHandledEvent</td><td>RequestHandledEvent + 서블릿 정보</td></tr></table><li>예시 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/event/MyEvent1.java" lan="java">Event</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/event/MyEvent1Publisher.java" lan="java">Publisher</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/event/MyEvent1Listener1.java" lan="java">Listener</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/test/java/io/github/donggi/example/event/Event1Tests.java" lan="java">Test</button></li><li>@EventListener 예시 <button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/event/MyEvent2.java" lan="java">Event</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/event/MyEvent2Publisher.java" lan="java">Publisher</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/event/MyEvent2Listener1.java" lan="java">Listener1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/main/java/io/github/donggi/example/event/MyEvent2Listener2.java" lan="java">Listener2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/ioc-example/src/test/java/io/github/donggi/example/event/Event2Tests.java" lan="java">Test</button></li><li>이벤트 핸들러가 다른 이벤트를 반환하는 경우, 해당 이벤트가 발행된다. 이벤트에 대한 컬렉션을 반환하면, 각각이 모두 발행된다</li><p>단, @Async 메서드는 수동으로 발행해야 한다.</p><li>@Order로 리스너 호출 순서를 제어할 수 있다</li><li>@EventListener > condition에 사용 가능한 SpEL 이벤트 메타데이터</li><table><tr><th>code</th><th>description</th></tr><tr><td>#root.event, event</td><td>ApplicationEvent 인스턴스</td></tr><tr><td>#root.args, args</td><td>메서드 파라미터 배열</td></tr><tr><td>#name, #a0, #p0</td><td>이름 또는 인덱스로 지정한 메서드 파라미터</td></tr></table></ul><h5 class="marker">ApplicationContext → ResourceLoader</h5><ul><li>Resource ::= java.net.URL을 포함한 클래스 패스 또는 파일 시스템 상의 리소스</li><li>ApplicationContext는 그 자체로 ResourceLoader며, 저수준 Resource 획득을 쉽게 해준다</li><li>ResourceLoaderAware를 구현한 빈들은 초기화 시 ApplicationContext를 ResourceLoader로 전달받는다</li><li>ClassPathXmlAPplicationContext에 간단한 경로로 리소스를 질의하는 경우, 클래스 패스 상의 리소스를 찾는다.</li><p>애매한 경우, 명시적으로 classpath:, file: 등 URL을 지정해야 한다.</p></ul></div></div></div></div><details><summary>정리중...                    </summary><details><summary>Spring AOP</summary><details><summary>AOP 개념</summary><ol><li>Aspect : 횡단 관심사. 로깅/보안 등, 여러 객체를 가로질러 공통적으로 사용되는 모듈/기능</li><li>Join Point : Aspect 실행 지점</li><li>Advice : Join Point에서 실행되는 코드</li><li>Pointcut : 일치하는 Join Point에 대한<a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="https://www.eclipse.org/aspectj/doc/next/progguide/semantics-pointcuts.html">정규 표현식</a></li>Advice는 Pointcut과 연관되며, 일치하는 모든 Join Point에서 실행된다.<li>Weaving : Advice 코드를 삽입</li>세 가지 Weaving 방식 : 컴파일 타임 위빙, 클래스 로드 타임 위빙, 런타임 위빙</ol></details><details><span id="pos-941319825" style="padding:0!important;margin:0!important;width:0!important;height:0!important;overflow:hidden!important"></span><summary>Spring AOP</summary><ul><li>스프링은 인터페이스의 프록시를 만들어 Aspect의 실행을 삽입한다</li>따라서 final이거나, 인터페이스에 정의되지 않은 메서드는 Aspect 삽입이 불가능하다</ul><details><summary>지원하는 Advice 종류</summary><table><thead><tr><th>종류</th><th>aop 태그</th><th>적용 시점</th></tr></thead><tbody><tr><td>Before</td><td>aop:before</td><td>메서드 실행 전</td></tr><tr><td>After Returning</td><td>aop:after-returning</td><td>메서드 정상 종료 후</td></tr><tr><td>After Throwing</td><td>aop:after-throwing</td><td>메서드 예외 throw시 적용</td></tr><tr><td>After</td><td>aop:after</td><td>after-returning + after-throwing</td></tr><tr><td>Around</td><td>aop:around</td><td>before + after</td></tr></tbody></table></details><details><summary>각 Advice별 예시 코드</summary><ul><li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/advice/BeforeAdvice.java" lan="java">Before Advice 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans2.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/BeforeAdviceTest.java" lan="java">테스트 클래스</button></li>Before Advice에서 예외를 던지면 실제 메서드는 호출되지 않는 효과가 있다.<li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/advice/AfterAdvice.java" lan="java">After Returning Advice 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans3.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/AfterAdviceTest.java" lan="java">테스트 클래스</button></li><li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/advice/AfterAdvice2.java" lan="java">After Throwing Advice 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans4 -> 변경.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/AfterAdviceTest2.java" lan="java">테스트 클래스</button></li><li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/advice/AfterAdvice3.java" lan="java">After Advice 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans5.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/AfterAdviceTest3.java" lan="java">테스트 클래스</button></li><li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/advice/AfterAdvice2.java" lan="java">Around Advice 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans1.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/TimerAdviceTest.java" lan="java">테스트 클래스</button></li></ul></details><details><summary>@Aspect를 이용한 위빙</summary><ul><li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/aspect/BeforeAspect.java" lan="java">Before Aspect 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans7.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/BeforeAdviceTest2.java" lan="java">테스트 클래스</button></li><li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/aspect/AfterAspect.java" lan="java">After Returning Aspect 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans8.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/AfterAdviceTest4.java" lan="java">테스트 클래스</button></li><li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/aspect/AfterAspect2.java" lan="java">After Throwing Aspect 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans9.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/AfterAdviceTest5.java" lan="java">테스트 클래스</button></li><li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/aspect/AfterAspect3.java" lan="java">After Aspect 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans10.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/AfterAdviceTest6.java" lan="java">테스트 클래스</button></li><li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/aspect/AroundAspect.java" lan="java">Around Aspect 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans6.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/TimerAdviceTest2.java" lan="java">테스트 클래스</button></li></ul></details><details><summary>JoinPoint#getArgs 대신 Pointcut 정의로 매개변수 직접 받기</summary><ul><li>xml 설정<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/advice/BeforeAdvice2.java" lan="java">Before Advice 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans11.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/BeforeAdviceTest3.java" lan="java">테스트 클래스</button></li><li>애너테이션 설정<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/main/java/io/github/donggi/aspect/BeforeAspect2.java" lan="java">Before Aspect 클래스</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/resources/beans/Beans12.xml" lan="xml">빈 구성 파일</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-aop/src/test/java/io/github/donggi/advice/BeforeAdviceTest4.java" lan="java">테스트 클래스</button></li></ul></details><details><summary>AspectJ Pointcut 표기법</summary><ol><li>execution : 특정 메서드에 대해 호출 시점 정의</li>[접근한정자]? [리턴_타입_패턴] [클래스_이름_패턴]?[메서드_이름_패턴]([매개변수_패턴])<br>execution(* set*(..)) : 모든 세터 메서드 호출<li>within : 특정 타입에 대해 호출 시점 정의</li>within(io.github.donggi.service.PrintService) : 해당 인터페이스의 모든 메서드 호출<br>within(io.github.donggi.service.*) : 해당 패키지의 모든 메서드 호출<li>bean : 특정 빈에 대해 호출 시점 정의</li><li>* ::= 각 패턴에 대해 모든 값을 허용함을 의미</li><li>.. ::= 0개 이상 반복에 대응함을 의미</li><li>&& ::= 패턴 AND</li><li>::= 패턴 OR</li></ol></details><ul><li>Aspect 적용 순서 정의</li>@Order(xml에서는 order 속성)를 적용하거나 Ordered 인터페이스 구현</ul></details></details><hr><details><summary>Spring MVC</summary><ol><li>DispatcherServlet : 클라이언트 요청을 받아 컨트롤러에 처리를 넘긴다.</li>각 DispatcherServlet은 하나의 WebApplicationContext를 갖는다<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/web.xml" lan="xml">WEB-INF/web.xml</button><br>기본적으로 {서블릿_이름}-servlet.xml 설정을 읽어온다<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/dispatcher-servlet.xml" lan="xml">WEB-INF/dispatcher-servlet.xml</button><br>설정 파일을 직접 지정하려면 DispatcherServlet의 "contextConfigLocation" init-param을 지정하면 된다. 각 경로들은 ',', ' ', '\n' 등으로 구분하면 된다. 클래스패스에 있는 파일은 classpath:conf.xml처럼 지정하면 된다<br>여러 DispatcherServlet을 이용하면서도 두 WebApplicationContext이 공통적으로 가져야 하는 빈이 있다면 ContextLoaderListener를 설정하면 된다<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/applicationContext.xml" lan="xml">WEB-INF/applicationContext.xml</button><li>HandlerMapping : 클라이언트의 요청 URL을 어떤 컨트롤러가 처리할 지 결정한다.</li><ul><li>요청 URL의 매핑을 항상 전체 경로로만 하려는 경우</li>스프링 설정에서 아래 2개의 기본 구현체의 alwaysUseFullPath 설정을 변경<br>&lt;bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" p:alwaysUseFullPath="true"/><br>&lt;bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter" p:alwaysUseFullPath="true"/><li>RESTful URI<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/HelloController.java" lan="java">예시</button></li></ul></ol><details><summary>@RequestMapping 사용 시 가능한 파라미터 타입</summary><ol><li>서블릿 API 관련 : (Http)ServletRequest, (Http)ServletResponse, HttpSession<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/HelloController.java" lan="java">예시</button></li><li>요청 Locale : java.util.Locale</li><li>요청/응답 직접 액세스 : InputStream, Reader, OutputStream, Writer</li><li>URI 템플릿 변수 : @PathVariable</li><li>HTTP 요청 파라미터 : @RequestParam</li><li>HTTP 요청 헤더 : @RequestHeader</li><li>HTTP 쿠키 : @CookieValue</li><li>HTTP 요청 : @RequestBody</li><li>뷰에 전달할 모델 : Map, Model, ModelMap</li><li>POJO : 각 POJO 클래스<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/LoginController.java" lan="java">예시1</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/view/login.jsp" lan="xml">login.jsp</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/BulkLoginController.java" lan="java">예시2</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/view/bulkLogin.jsp" lan="xml">bulkLogin.jsp</button></li><li>Multipart 폼 데이터 예시</li>CommonsMultipartResolver 이용(commons-fileupload 패키지 의존)<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/dispatcher-servlet.xml" lan="xml">WEB-INF/dispatcher-servlet.xml</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/view/upload.jsp" lan="xml">upload.jsp</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/FileController.java" lan="java">FileController</button><li>POJO로의 바인딩 결과 : Errors, BindingResult</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/LoginController.java" lan="java">@Valid, @InitBinder 예시</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/validator/LoginRequestValidator.java" lan="java">Validator 예시</button><li>SessionStatus</li></ol></details><ol><li>Controller : 클라이언트의 요청을 처리한 뒤 결과를 DispatcherServlet에 넘긴다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/HelloController.java" lan="java">예시</button></li></ol><details><summary>컨트롤러 메서드의 반환 타입</summary><ol><li>ModelAndView : 뷰 정보 + 모델 정보</li><li>Model, Map : 모델 정보. 뷰 이름은 요청 URL로부터 결정(RequestToViewNameTranslator)된다.</li><li>String : 뷰 이름</li><li>View : 뷰 인스턴스(org.springframework.web.servlet.View)</li><li>void : 메서드가 (Http)ServletRequest를 매개변수로 받는다면 직접 응답을 처리한다고 가정한다. 그 외의 경우, 뷰 이름은 요청 URL로부터 결정.</li><li>메서드에 @ResponseBody가 적용된 경우 반환 객체를 HTTP 응답으로(HttpMessageConverter) 전송한다.
AJAX에 유용.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/EtcController.java" lan="java">예시</button></li><li>뷰 이름을 통한 리다이렉트 : "redirect:" 접두어 활용. 상대 경로, 절대 경로 모두 가능</li></ol></details><ol><li>ModelAndView : 컨트롤러의 처리 결과와 뷰 생성에 필요한 정보</li><li>ViewResolver : 생성할 뷰를 결정한다.</li><li>View : 컨트롤러의 처리 결과를 클라이언트에 보낼 형태로 생성한다</li><li>예외 처리</li><ul><li>기본 예외 페이지 설정 :<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/web.xml" lan="xml">WEB-INF/web.xml</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/view/error.jsp" lan="xml">error.jsp</button></li><li>컨트롤러 내부 @ExceptionHandler 메서드 선언 :<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/HelloController.java" lan="java">예시</button></li><li>컨트롤러 HandlerExceptionResolver 인터페이스 구현 :<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/controller/FileController.java" lan="java">예시</button></li><li>SimpleMappingExceptionResolver로 전체 컨트롤러 특정 예외를 특정 뷰로 연결 :<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/webapp/WEB-INF/dispatcher-servlet.xml" lan="xml">WEB-INF/dispatcher-servlet.xml</button></li><li>@ControllerAdvice를 이요한 특정 패키지/클래스/인터페이스 예외 처리 :<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/advice/UnhandledExceptionAdvice.java" lan="java">예시</button></li></ul><li>사용자 정의 PropertyEditor<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/main/java/io/github/donggi/advice/InitAdvice.java" lan="java">예시</button></li></ol></details><h2 class="marker">Spring 트랜잭션 사용하기</h2><ul><li>관련 클래스</li><p>AbstractPlatformTransactionManager ← DataSourceTransactionManager(JDBC), HibernateTransactionManager, JtaTransactionManager</p><li>예시 코드</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-transaction/pom.xml" lan="xml">pom.xml »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-transaction/src/main/resources/applicationContext.xml" lan="xml">applicationContext.xml »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-transaction/src/main/java/io/github/donggi/service/NameService.java" lan="java">NameService.java »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-transaction/src/test/java/Test.java" lan="java">Test.java »</button></ul><hr><details><summary>Spring JUnit</summary><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-transaction/src/test/java/Test.java" lan="java">예시 코드 1 »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Eclipse/spring-mvc/src/test/java/Test.java" lan="java">예시 코드 2 »</button></details><hr><details><summary>Spring Boot</summary><details><summary>Spring Boot Web Microservice</summary><ol><li>예시 코드</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/rest-microservice/pom.xml" lan="xml">pom.xml</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/rest-microservice/src/main/java/io/github/donggi/controller/HelloController.java" lan="java">HelloController.java</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/rest-microservice/src/test/java/io/github/donggi/controller/HelloControllerTest.java" lan="java">HelloControllerTest.java</button><li>스프링 부트 마이크로서비스는 실행에 필요한 모든 의존 라이브러리, HTTP 리스너 등을 하나의 jar로 패키징한다</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20191006_180335.png" class="w3-round"></div><div class="w3-center w3-margin-bottom"><img src="/imgs/20191006_180348.png" class="w3-round"></div><div class="w3-center w3-margin-bottom"><img src="/imgs/20191006_180401.png" class="w3-round"></div><li>mvn install하면 bootJar가 빌드된다<br>java -jar target/rest-microservice-0.0.1-SNAPSHOT.jar</li></ol></details><details><summary>Gradle 프로젝트 빌드 및 실행</summary><ol><li>bootRun 실행</li>gradle app-name:bootRun -Pprofile=dev<li>bootJar 빌드</li>gradle app-name:bootJar -x test<li>bootJar 실행</li>java -jar -Dspring.profiles.active=dev app-name.jar<li>디버그 포트 열기</li>-Xdebug -Xrunjdwp:server=y,transport=dt_socket,address=55555,suspend=n<br>suspend=y로 하는 경우, 디버그 연결까지 실행을 대기한다, 허용 서브넷 명시 : address=*:55555, address=0.0.0.0:55555</ol></details><details open=""><summary>application.properties 서버 포트 지정</summary>server.port=18080<br>tomcatPort=18009<br>tomcatRedirectPort=18443</details><details><summary>Spring Boot Reactive Web Microservice</summary><ol><li>예시 코드</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/reactive-webflux/pom.xml" lan="xml">pom.xml</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/reactive-webflux/src/main/java/io/github/donggi/controller/HelloController.java" lan="java">HelloController.java</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/reactive-webflux/src/test/java/io/github/donggi/controller/HelloControllerTest.java" lan="java">HelloControllerTest.java</button><div class="w3-center w3-margin-bottom"><img src="/imgs/20191008_110029.png" class="w3-round"></div><li>리액티브 스트림 : java.util.concurrent.Flow</li><ul><li>Publisher : 발행자. subscribe​(Subscriber)</li><li>Subscriber : 구독자. onSubscribe(Subscription), onNext(T), onError(Throwable), onComplete(Void)</li><li>Subscription : 구독. request(long), cancel(Void)</li><li>Processor extends Subscriber, Publisher : 발행자 + 구독자</li></ul><li>리액터의 발행자 Processor</li><ul><li>reactor.core.publisher.Mono : 0 또는 1개의 이벤트 발행</li><li>reactor.core.publisher.Flux : 0 또는 n개의 이벤트 발행</li></ul></ol></details><details><summary>CORS 허용</summary><ol><li>컨트롤러 클래스 또는 메서드에 @CrossOrigin 설정</li><li>WebMvcConfigurer 빈의 addCorsMappings(CorsRegistry)를 재정의하여 앱 전체 설정 변경</li></ol></details><details><summary>Spring Config Server</summary><ol><li>Config Server 선택</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20191009_095724.png" class="w3-round"></div><li>예시 코드</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/config-server/src/main/resources/bootstrap.properties" lan="text">bootstrap.properties</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/config-server/src/main/java/io/github/donggi/ConfigServerApplication.java" lan="java">@EnableConfigServer</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Config/webapp.properties" lan="text">webapp.properties</button><br><li>접근 예</li>http://localhost:28888/webapp/default<br>http://localhost:28888/webapp/default/master/test.xml<ul><li>/{application}/{profile}[/{label}]</li><li>/{application}-{profile}.yml</li><li>/{label}/{application}-{profile}.yml</li><li>/{application}-{profile}.properties</li><li>/{label}/{application}-{profile}.properties</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20191009_115402.png" class="w3-round"></div></ul><li>갱신 : http://localhost:28888/actuator/refresh</li></ol></details><details><summary>Spring Config Client</summary><ol><li>Config Client, Actuator 선택</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20191009_124833.png" class="w3-round"></div><li>예시 코드</li><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/Config/config-client.properties" lan="text">config-client.properties</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/config-client/src/main/resources/bootstrap.properties" lan="text">bootstrap.properties</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/config-client/src/main/java/io/github/donggi/controller/HelloController.java" lan="java">HelloController.java</button><li>접근 예 http://localhost:18888/hello</li><div class="w3-center w3-margin-bottom"><img src="/imgs/20191009_122755.png" class="w3-round"></div><li>갱신 : POST http://localhost:18888/actuator/refresh</li>http://localhost:18888/actuator/에 접속했을 때 /refresh가 보이지 않는다면 management.security.enabled=false, management.endpoints.web.exposure.include=* 2개 설정 확인<div class="w3-center w3-margin-bottom"><img src="/imgs/20191009_124710.png" class="w3-round"></div><div class="w3-center w3-margin-bottom"><img src="/imgs/20191009_124647.png" class="w3-round"></div></ol></details><ol><li>@Async</li>메서드를 스프링이 관리하는 ThreadExecutor에서 비동기적으로 실행하는 프록시를 생성한다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/web-app/src/main/java/io/github/donggi/WebAppApplication.java" lan="java">@EnableAsync »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/web-app/src/main/java/io/github/donggi/controller/SleepController.java" lan="java">@Async »</button><li>@Scheduled</li>메서드를 명시적으로 호출하지 않아도 스케쥴대로 실행된다.<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/web-app/src/main/java/io/github/donggi/WebAppApplication.java" lan="java">@EnableScheduling »</button><button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/web-app/src/main/java/io/github/donggi/controller/HelloController.java" lan="java">@Scheduled »</button></ol></details><hr><details><summary>WebSocket</summary><ul><li>HTTP/1.1 업그레이드 기능을 이용해 기존 HTTP/HTTPS를 웹 소켓 연결 WS/WSS로 그대로 전환</li>사용하던 80/443포트 그대로 연결하므로 방화벽의 차단에도 안전. 프록시 서버가 HTTP 업그레이드를 처리하지 않는다면 WSS를 이용.<li>웹소켓 API Since JavaEE 7</li><ul><li>javax.websocket : 클라이언트/서버 공통 기능</li><ul><li>WebSocketContainer</li>웹소켓 클라이언트 기능. connectToServer()<li>ContainerProvider</li>웹소켓 클라이언트 인스턴스 획득을 위한 getWebSocketContainer()<li>@interface ClientEndpoint</li>POJO가 클라이언트측 웹소켓임을 나타낸다. 해당 클래스는 메서드는 @OnOpen, @OnClose, @OnError, @OnMessage 애너테이트될 수 있다<li>@interface OnOpen + OnClose</li>선택적 Session 매개변수, 선택적 EndpointConfig 매개변수, 0 ~ n개 @PathParam String 매개변수를 가질 수 있다<li>@interface OnError</li>선택적 Session 매개변수, Throwable 매개변수, 0 ~ n개 @PathParam String 매개변수를 가질 수 있다<li>@interface OnMessage</li>선택적 Session 매개변수, 0 ~ n개 @PathParam String 매개변수, 아래 중 하나의 메시지 매개변수<ul><li>텍스트 메시지 처리</li><ul><li>전체 메시지 String</li><li>메시지로부터 변환되는 Java primitive or class</li><li>메시지 청크 String and boolean pair : 마지막 메시지는 true</li><li>전체 메시지 Reader</li><li>Decoder.Text or Decoder.TextStream</li></ul><li>이진 메시지 처리</li><ul><li>전체 메시지 byte[] or ByteBuffer</li><li>메시지 청크 (byte[] or ByteBuffer) and boolean pair : 마지막 메시지는 true</li><li>전체 메시지 InputStream</li><li>Decoder.Binary or Decoder.BinaryStream</li></ul><li>퐁 메시지 처리 : PongMessage</li></ul></ul><li>javax.websocket.server : 서버 전용 기능</li><ul><li>ServerContainer extends WebSocketContainer</li>ServerEndpointConfig 인스턴스 또는 @ServerEndpoint 클래스 등록</ul></ul><li>Spring Boot 예시</li><ul><li>웹소켓 API를 사용하기 위해 javax.websocket-api, 스프링의 관리를 위해 spring-websocket 필요<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/web-app/pom.xml" lan="xml">pom.xml »</button></li><li>스프링이 Endpoint를 찾아 알아서 빈을 생성하도록 ServerEndpointExporter 생성<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/web-app/src/main/java/io/github/donggi/config/WebSocketConfig.java" lan="java">WebSocketConfig.java »</button></li><li>@ServerEndpoint 예<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/web-app/src/main/java/io/github/donggi/websocket/Echo.java" lan="java">Echo.java »</button></li>@ServerEndpoint 안에서 @Autowired 주입을 위해 @ServerEndpoint(configurator = ServerEndpointConfigurator.class)를 설정하고 @PostConstruct에서 주입을 실행했음을 참고<button class="w3-btn w3-round w3-round-xxlarge w3-small w3-teal btn-code" title="/Repositories/STS/web-app/src/main/java/io/github/donggi/config/ServerEndpointConfigurator.java" lan="java">ServerEndpointConfigurator.java »</button></ul></ul></details><hr></details><div class="w3-container w3-leftbar w3-border-green w3-white hover-template" id="template-jsr330"><p>별도 jar 포함 필요</p><p><strong>↓ xml</strong></p><div lan="xml" class="as-code code-div w3-leftbar w3-border-green">&lt;dependency>
    &lt;groupId>javax.inject&lt;/groupId>
    &lt;artifactId>javax.inject&lt;/artifactId>
    &lt;version>1&lt;/version>
&lt;/dependency></div><p><strong>↓ gradle</strong></p><div lan="gradle" class="as-code code-div w3-leftbar w3-border-green">implementation 'javax.inject:javax.inject:1'</div></div></div><hr>&copy; 2020. <a href="mailto:hi.donggi@gmail.com">Donggi Kim</a> all rights reserved.<a class="w3-btn w3-round w3-round-xxlarge w3-small w3-green" href="/LICENSE">LICENSE</a></div></body></html>